<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redux Middleware & Data Optimization - Interactive Learning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            animation: fadeInDown 0.8s ease;
        }

        header p {
            font-size: 1.3em;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 50px;
            padding: 35px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 6px solid #667eea;
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 2.2em;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section h3 {
            color: #764ba2;
            margin: 30px 0 20px 0;
            font-size: 1.7em;
        }

        .definition {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid #2196F3;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .definition strong {
            color: #1976D2;
            font-size: 1.2em;
            display: block;
            margin-bottom: 10px;
        }

        .hinglish {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid #ff9800;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .demo-box {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border: 2px solid #e0e0e0;
        }

        .demo-box h3 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            margin: 8px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            overflow-x: auto;
            position: relative;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            font-size: 14px;
            line-height: 1.6;
        }

        .code-block::before {
            content: 'JavaScript';
            position: absolute;
            top: 12px;
            right: 15px;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: bold;
        }

        .keyword { color: #c792ea; font-weight: bold; }
        .string { color: #c3e88d; }
        .comment { color: #546e7a; font-style: italic; }
        .function { color: #82aaff; }
        .number { color: #f78c6c; }
        .property { color: #ffcb6b; }

        .middleware-flow {
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 30px;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
            border-radius: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .flow-box {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            min-width: 140px;
            margin: 10px;
            transition: all 0.3s;
            position: relative;
        }

        .flow-box:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .flow-box.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .flow-arrow {
            font-size: 2.5em;
            color: #667eea;
            animation: slideRight 2s infinite;
        }

        @keyframes slideRight {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        .log-console {
            background: #1e1e1e;
            color: #4caf50;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
            font-size: 13px;
            line-height: 1.8;
        }

        .log-entry {
            margin: 8px 0;
            padding: 8px;
            border-left: 3px solid #4caf50;
            padding-left: 12px;
        }

        .log-action {
            color: #82aaff;
        }

        .log-state {
            color: #ffcb6b;
        }

        .log-error {
            color: #f44336;
            border-left-color: #f44336;
        }

        .log-time {
            color: #78909c;
            font-size: 11px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border-top: 4px solid #667eea;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .performance-meter {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .meter-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
            position: relative;
        }

        .meter-fill {
            height: 100%;
            background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .meter-fill.slow {
            background: linear-gradient(90deg, #eb3349 0%, #f45c43 100%);
        }

        .meter-fill.medium {
            background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table tr:hover {
            background: #f5f5f5;
        }

        .interview-section {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 50px 40px;
            border-radius: 15px;
            margin-top: 50px;
        }

        .interview-section h2 {
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .question {
            background: white;
            color: #333;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .question:hover {
            transform: translateX(10px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .question h4 {
            color: #f5576c;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2em;
        }

        .question-icon {
            font-size: 1.5em;
            transition: transform 0.3s;
        }

        .question.active .question-icon {
            transform: rotate(180deg);
        }

        .answer {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #f093fb;
            line-height: 1.8;
        }

        .answer.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: bold;
            margin: 5px;
        }

        .badge-success {
            background: #d4edda;
            color: #155724;
        }

        .badge-error {
            background: #f8d7da;
            color: #721c24;
        }

        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .highlight-box {
            background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #fbc02d;
            margin: 20px 0;
        }

        .pro-tip {
            background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #0288d1;
            margin: 20px 0;
        }

        .pro-tip::before {
            content: 'üí° Pro Tip: ';
            font-weight: bold;
            color: #0277bd;
        }

        .selector-demo {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border: 2px solid #667eea;
        }

        .selector-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat-box {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 150px;
            margin: 10px;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            .content {
                padding: 20px;
            }

            .section {
                padding: 20px;
            }

            .middleware-flow {
                flex-direction: column;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 25px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-weight: 600;
            color: #666;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .memoization-visual {
            display: flex;
            justify-content: space-around;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .memo-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin: 10px;
            min-width: 200px;
            text-align: center;
        }

        .memo-box.cached {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 2px solid #28a745;
        }

        .memo-box.computing {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 2px solid #ffc107;
            animation: pulse 1s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚öôÔ∏è Redux Middleware & Data Optimization</h1>
            <p>Day 31: Master Advanced Redux Patterns</p>
        </header>

        <div class="content">
            <!-- Introduction Section -->
            <div class="section">
                <h2>üìö Middleware Kya Hai?</h2>
                
                <div class="definition">
                    <strong>Middleware:</strong> A function that sits between dispatching an action and the moment it reaches the reducer. It provides a third-party extension point between dispatching an action and the reducer receiving it, allowing you to intercept, modify, delay, or even stop actions.
                </div>

                <div class="hinglish">
                    <p><strong>Simple shabdon mein:</strong> Middleware ek "middleman" hai jo action aur reducer ke beech mein baithta hai. Jaise airport pe security check hota hai passengers ke liye, waise hi middleware har action ko check kar sakta hai, modify kar sakta hai, ya extra kaam kar sakta hai! üõÇ</p>
                    <p><strong>Real-world analogy:</strong> Socho aap ek letter bhej rahe ho. Post office (middleware) letter ko receive karta hai, stamp lagata hai, tracking add karta hai, aur phir deliver karta hai. Middleware bhi aise hi actions ke saath kaam karta hai!</p>
                </div>

                <h3>üîÑ Middleware Flow Visualization</h3>
                <div class="middleware-flow">
                    <div class="flow-box">
                        <h4>üé¨ Action</h4>
                        <p>Dispatch</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box active">
                        <h4>‚öôÔ∏è Middleware 1</h4>
                        <p>Logger</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box active">
                        <h4>‚öôÔ∏è Middleware 2</h4>
                        <p>Thunk</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box active">
                        <h4>‚öôÔ∏è Middleware 3</h4>
                        <p>Error Handler</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">
                        <h4>üì¶ Reducer</h4>
                        <p>State Update</p>
                    </div>
                </div>

                <div class="code-block">
<span class="comment">// Middleware Signature (Curried Function)</span>
<span class="keyword">const</span> <span class="function">middleware</span> = (store) => (next) => (action) => {
  <span class="comment">// store: Redux store ka access</span>
  <span class="comment">// next: Agle middleware ya reducer ko call karne ke liye</span>
  <span class="comment">// action: Current action object</span>
  
  <span class="comment">// Before reducer</span>
  console.<span class="function">log</span>(<span class="string">'Action dispatched:'</span>, action);
  
  <span class="comment">// Call next middleware/reducer</span>
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  
  <span class="comment">// After reducer</span>
  console.<span class="function">log</span>(<span class="string">'New state:'</span>, store.<span class="function">getState</span>());
  
  <span class="keyword">return</span> result;
};
                </div>
            </div>

            <!-- Custom Middleware Section -->
            <div class="section">
                <h2>1Ô∏è‚É£ Custom Middleware Banana</h2>

                <div class="definition">
                    <strong>Custom Middleware:</strong> User-defined middleware functions that implement specific logic for handling actions, such as logging, analytics, crash reporting, or custom business logic.
                </div>

                <div class="hinglish">
                    <p><strong>Kyun banana?</strong> Redux mein built-in middleware limited hain. Aapko apne specific use cases ke liye custom middleware banana padta hai - jaise analytics tracking, API calls, validation, etc.</p>
                </div>

                <div class="grid">
                    <div class="card">
                        <h3>üìù Logger Middleware</h3>
                        <p>Har action aur state change ko log karo</p>
                        <span class="badge badge-info">Debugging</span>
                    </div>
                    <div class="card">
                        <h3>üö® Error Handler</h3>
                        <p>Errors ko catch aur report karo</p>
                        <span class="badge badge-error">Error Tracking</span>
                    </div>
                    <div class="card">
                        <h3>üìä Analytics</h3>
                        <p>User actions ko track karo</p>
                        <span class="badge badge-success">Monitoring</span>
                    </div>
                    <div class="card">
                        <h3>‚è±Ô∏è Performance</h3>
                        <p>Action execution time measure karo</p>
                        <span class="badge badge-warning">Optimization</span>
                    </div>
                </div>

                <div class="demo-box">
                    <h3>üéØ Live Demo: Custom Middleware in Action</h3>
                    <p>Neeche buttons click karo aur dekho middleware kaise kaam karta hai!</p>
                    
                    <div style="margin: 20px 0;">
                        <button class="btn" onclick="dispatchAction('INCREMENT')">‚ûï Increment</button>
                        <button class="btn btn-danger" onclick="dispatchAction('DECREMENT')">‚ûñ Decrement</button>
                        <button class="btn btn-warning" onclick="dispatchAction('ASYNC_ACTION')">‚è≥ Async Action</button>
                        <button class="btn btn-info" onclick="dispatchAction('ERROR_ACTION')">‚ùå Error Action</button>
                        <button class="btn btn-success" onclick="clearLogs()">üóëÔ∏è Clear Logs</button>
                    </div>

                    <div class="log-console" id="middleware-logs">
                        <div class="log-entry">
                            <span class="log-time">[00:00:00]</span> 
                            <span style="color: #4caf50;">‚úì Middleware system initialized</span>
                        </div>
                    </div>
                </div>

                <div class="code-block">
<span class="comment">// 1. Logger Middleware - Har action ko log karo</span>
<span class="keyword">const</span> <span class="function">loggerMiddleware</span> = (store) => (next) => (action) => {
  console.<span class="function">group</span>(<span class="string">`Action: ${action.type}`</span>);
  console.<span class="function">log</span>(<span class="string">'Previous State:'</span>, store.<span class="function">getState</span>());
  console.<span class="function">log</span>(<span class="string">'Action:'</span>, action);
  
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  
  console.<span class="function">log</span>(<span class="string">'Next State:'</span>, store.<span class="function">getState</span>());
  console.<span class="function">groupEnd</span>();
  
  <span class="keyword">return</span> result;
};

<span class="comment">// 2. Performance Middleware - Execution time measure karo</span>
<span class="keyword">const</span> <span class="function">performanceMiddleware</span> = (store) => (next) => (action) => {
  <span class="keyword">const</span> start = performance.<span class="function">now</span>();
  
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  
  <span class="keyword">const</span> end = performance.<span class="function">now</span>();
  <span class="keyword">const</span> duration = end - start;
  
  <span class="keyword">if</span> (duration > <span class="number">10</span>) {
    console.<span class="function">warn</span>(<span class="string">`Slow action: ${action.type} took ${duration}ms`</span>);
  }
  
  <span class="keyword">return</span> result;
};

<span class="comment">// 3. Error Handler Middleware - Errors ko catch karo</span>
<span class="keyword">const</span> <span class="function">errorMiddleware</span> = (store) => (next) => (action) => {
  <span class="keyword">try</span> {
    <span class="keyword">return</span> <span class="function">next</span>(action);
  } <span class="keyword">catch</span> (error) {
    console.<span class="function">error</span>(<span class="string">'Error in action:'</span>, action.type, error);
    
    <span class="comment">// Error reporting service ko bhejo</span>
    <span class="function">reportError</span>(error, { action, state: store.<span class="function">getState</span>() });
    
    <span class="comment">// Error action dispatch karo</span>
    store.<span class="function">dispatch</span>({
      type: <span class="string">'ERROR_OCCURRED'</span>,
      payload: error.message
    });
    
    <span class="keyword">return</span> error;
  }
};

<span class="comment">// 4. Analytics Middleware - User actions track karo</span>
<span class="keyword">const</span> <span class="function">analyticsMiddleware</span> = (store) => (next) => (action) => {
  <span class="comment">// Track specific actions</span>
  <span class="keyword">if</span> (action.type.<span class="function">startsWith</span>(<span class="string">'USER_'</span>)) {
    <span class="function">trackEvent</span>({
      event: action.type,
      properties: action.payload,
      timestamp: <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>()
    });
  }
  
  <span class="keyword">return</span> <span class="function">next</span>(action);
};

<span class="comment">// Apply middleware to store</span>
<span class="keyword">import</span> { applyMiddleware, createStore } <span class="keyword">from</span> <span class="string">'redux'</span>;

<span class="keyword">const</span> store = <span class="function">createStore</span>(
  rootReducer,
  <span class="function">applyMiddleware</span>(
    loggerMiddleware,
    performanceMiddleware,
    errorMiddleware,
    analyticsMiddleware
  )
);
                </div>

                <div class="pro-tip">
                    Middleware ka order matter karta hai! Jo pehle apply hoga, wo pehle execute hoga. Logger ko usually sabse pehle rakhte hain taaki sab kuch log ho sake.
                </div>
            </div>

            <!-- Thunk Deep Dive Section -->
            <div class="section">
                <h2>2Ô∏è‚É£ Redux Thunk - Deep Dive</h2>

                <div class="definition">
                    <strong>Redux Thunk:</strong> A middleware that allows you to write action creators that return a function instead of an action object. The thunk can be used to delay the dispatch of an action, or to dispatch only if a certain condition is met.
                </div>

                <div class="hinglish">
                    <p><strong>Kya hai Thunk?</strong> Thunk ek function hai jo function return karta hai! ü§Ø Normally action creators objects return karte hain, but thunk se aap functions return kar sakte ho jo async operations kar sakein.</p>
                    <p><strong>Kyun chahiye?</strong> Redux mein reducers pure functions hone chahiye - no side effects, no async code. Thunk middleware se aap async operations (API calls, timers) kar sakte ho!</p>
                </div>

                <div class="code-block">
<span class="comment">// Redux Thunk Source Code (Simplified)</span>
<span class="keyword">const</span> <span class="function">thunk</span> = (store) => (next) => (action) => {
  <span class="comment">// Agar action ek function hai, toh use call karo</span>
  <span class="keyword">if</span> (<span class="keyword">typeof</span> action === <span class="string">'function'</span>) {
    <span class="keyword">return</span> <span class="function">action</span>(store.dispatch, store.getState);
  }
  
  <span class="comment">// Warna normal action ki tarah handle karo</span>
  <span class="keyword">return</span> <span class="function">next</span>(action);
};

<span class="comment">// Simple Thunk Example</span>
<span class="keyword">const</span> <span class="function">incrementAsync</span> = () => {
  <span class="keyword">return</span> (dispatch, getState) => {
    <span class="function">setTimeout</span>(() => {
      <span class="function">dispatch</span>({ type: <span class="string">'INCREMENT'</span> });
    }, <span class="number">1000</span>);
  };
};

<span class="comment">// API Call Thunk</span>
<span class="keyword">const</span> <span class="function">fetchUsers</span> = () => {
  <span class="keyword">return async</span> (dispatch, getState) => {
    <span class="comment">// Loading state</span>
    <span class="function">dispatch</span>({ type: <span class="string">'FETCH_USERS_REQUEST'</span> });
    
    <span class="keyword">try</span> {
      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'/api/users'</span>);
      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="function">json</span>();
      
      <span class="comment">// Success</span>
      <span class="function">dispatch</span>({
        type: <span class="string">'FETCH_USERS_SUCCESS'</span>,
        payload: data
      });
    } <span class="keyword">catch</span> (error) {
      <span class="comment">// Error</span>
      <span class="function">dispatch</span>({
        type: <span class="string">'FETCH_USERS_FAILURE'</span>,
        payload: error.message
      });
    }
  };
};
                </div>

                <div class="demo-box">
                    <h3>üéØ Live Demo: Thunk in Action</h3>
                    
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('simple-thunk')">Simple Thunk</button>
                        <button class="tab" onclick="switchTab('api-thunk')">API Thunk</button>
                        <button class="tab" onclick="switchTab('conditional-thunk')">Conditional Thunk</button>
                    </div>

                    <div id="simple-thunk" class="tab-content active">
                        <h4>Simple Async Thunk</h4>
                        <p>1 second delay ke baad increment hoga</p>
                        <button class="btn" onclick="simpleThunkDemo()">‚è±Ô∏è Increment After 1s</button>
                        <div class="stat-box" style="margin-top: 20px;">
                            <div class="stat-value" id="thunk-counter">0</div>
                            <div class="stat-label">Counter Value</div>
                        </div>
                    </div>

                    <div id="api-thunk" class="tab-content">
                        <h4>API Call Thunk</h4>
                        <p>Fetch users from API</p>
                        <button class="btn btn-info" onclick="apiThunkDemo()">üì• Fetch Users</button>
                        <div id="api-status" style="margin-top: 20px;"></div>
                        <div id="api-result" style="margin-top: 15px;"></div>
                    </div>

                    <div id="conditional-thunk" class="tab-content">
                        <h4>Conditional Thunk</h4>
                        <p>Sirf even numbers pe increment hoga</p>
                        <button class="btn btn-success" onclick="conditionalThunkDemo()">üéØ Conditional Increment</button>
                        <div class="stat-box" style="margin-top: 20px;">
                            <div class="stat-value" id="conditional-counter">0</div>
                            <div class="stat-label">Counter (Even Only)</div>
                        </div>
                    </div>
                </div>

                <div class="code-block">
<span class="comment">// Advanced Thunk Patterns</span>

<span class="comment">// 1. Conditional Dispatch - State check karke dispatch karo</span>
<span class="keyword">const</span> <span class="function">incrementIfOdd</span> = () => {
  <span class="keyword">return</span> (dispatch, getState) => {
    <span class="keyword">const</span> { counter } = <span class="function">getState</span>();
    
    <span class="keyword">if</span> (counter % <span class="number">2</span> === <span class="number">1</span>) {
      <span class="function">dispatch</span>({ type: <span class="string">'INCREMENT'</span> });
    }
  };
};

<span class="comment">// 2. Chained Thunks - Ek thunk dusre thunk ko dispatch kare</span>
<span class="keyword">const</span> <span class="function">fetchUserAndPosts</span> = (userId) => {
  <span class="keyword">return async</span> (dispatch) => {
    <span class="comment">// First fetch user</span>
    <span class="keyword">await</span> <span class="function">dispatch</span>(<span class="function">fetchUser</span>(userId));
    
    <span class="comment">// Then fetch their posts</span>
    <span class="keyword">await</span> <span class="function">dispatch</span>(<span class="function">fetchUserPosts</span>(userId));
  };
};

<span class="comment">// 3. Cancellable Thunk - AbortController use karo</span>
<span class="keyword">const</span> <span class="function">fetchWithCancel</span> = (url) => {
  <span class="keyword">let</span> abortController = <span class="keyword">new</span> <span class="function">AbortController</span>();
  
  <span class="keyword">const</span> thunk = <span class="keyword">async</span> (dispatch) => {
    <span class="keyword">try</span> {
      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="function">fetch</span>(url, {
        signal: abortController.signal
      });
      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="function">json</span>();
      <span class="function">dispatch</span>({ type: <span class="string">'SUCCESS'</span>, payload: data });
    } <span class="keyword">catch</span> (error) {
      <span class="keyword">if</span> (error.name === <span class="string">'AbortError'</span>) {
        console.<span class="function">log</span>(<span class="string">'Request cancelled'</span>);
      }
    }
  };
  
  thunk.cancel = () => abortController.<span class="function">abort</span>();
  <span class="keyword">return</span> thunk;
};

<span class="comment">// 4. Retry Logic - Failed requests ko retry karo</span>
<span class="keyword">const</span> <span class="function">fetchWithRetry</span> = (url, maxRetries = <span class="number">3</span>) => {
  <span class="keyword">return async</span> (dispatch) => {
    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i < maxRetries; i++) {
      <span class="keyword">try</span> {
        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="function">fetch</span>(url);
        <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="function">json</span>();
        <span class="function">dispatch</span>({ type: <span class="string">'SUCCESS'</span>, payload: data });
        <span class="keyword">return</span>;
      } <span class="keyword">catch</span> (error) {
        <span class="keyword">if</span> (i === maxRetries - <span class="number">1</span>) {
          <span class="function">dispatch</span>({ type: <span class="string">'FAILURE'</span>, payload: error });
        }
        <span class="keyword">await</span> <span class="keyword">new</span> <span class="function">Promise</span>(r => <span class="function">setTimeout</span>(r, <span class="number">1000</span> * (i + <span class="number">1</span>)));
      }
    }
  };
};
                </div>

                <div class="highlight-box">
                    <strong>üéØ Thunk Best Practices:</strong>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>Always handle loading, success, and error states</li>
                        <li>Use try-catch for error handling</li>
                        <li>Keep thunks focused on one responsibility</li>
                        <li>Return promises for better composition</li>
                        <li>Use getState() sparingly - prefer passing data as arguments</li>
                    </ul>
                </div>
            </div>

            <!-- Logging & Error Handling Section -->
            <div class="section">
                <h2>3Ô∏è‚É£ Logging & Error Handling Middleware</h2>

                <div class="definition">
                    <strong>Logging Middleware:</strong> Middleware that records actions, state changes, and other events for debugging and monitoring purposes. Error handling middleware catches and processes errors that occur during action processing.
                </div>

                <div class="hinglish">
                    <p><strong>Production mein kyun zaroori?</strong> Development mein toh console.log se kaam chal jata hai, but production mein proper logging aur error tracking chahiye. Jab user ko error aaye, aapko pata hona chahiye kya hua!</p>
                </div>

                <div class="grid">
                    <div class="card">
                        <h3>üìä Action Logging</h3>
                        <p>Har action ko timestamp ke saath log karo</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="keyword">const</span> logger = store => next => action => {
  console.<span class="function">log</span>(<span class="string">'dispatching'</span>, action);
  <span class="keyword">return</span> <span class="function">next</span>(action);
};
                        </div>
                    </div>

                    <div class="card">
                        <h3>üö® Error Tracking</h3>
                        <p>Errors ko catch aur report karo</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="keyword">const</span> errorHandler = store => next => action => {
  <span class="keyword">try</span> {
    <span class="keyword">return</span> <span class="function">next</span>(action);
  } <span class="keyword">catch</span> (err) {
    <span class="function">reportError</span>(err);
  }
};
                        </div>
                    </div>

                    <div class="card">
                        <h3>‚è±Ô∏è Performance Monitor</h3>
                        <p>Slow actions ko identify karo</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="keyword">const</span> perf = store => next => action => {
  <span class="keyword">const</span> start = Date.<span class="function">now</span>();
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  console.<span class="function">log</span>(Date.<span class="function">now</span>() - start);
  <span class="keyword">return</span> result;
};
                        </div>
                    </div>

                    <div class="card">
                        <h3>üìà State Diff</h3>
                        <p>State changes ko visualize karo</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="keyword">const</span> diff = store => next => action => {
  <span class="keyword">const</span> prev = store.<span class="function">getState</span>();
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  <span class="keyword">const</span> curr = store.<span class="function">getState</span>();
  console.<span class="function">log</span>(<span class="function">diff</span>(prev, curr));
  <span class="keyword">return</span> result;
};
                        </div>
                    </div>
                </div>

                <div class="code-block">
<span class="comment">// Production-Ready Logger Middleware</span>
<span class="keyword">const</span> <span class="function">createLogger</span> = (options = {}) => {
  <span class="keyword">const</span> {
    collapsed = <span class="keyword">true</span>,
    duration = <span class="keyword">true</span>,
    timestamp = <span class="keyword">true</span>,
    colors = {
      title: <span class="string">'#000'</span>,
      prevState: <span class="string">'#9E9E9E'</span>,
      action: <span class="string">'#03A9F4'</span>,
      nextState: <span class="string">'#4CAF50'</span>,
      error: <span class="string">'#F20404'</span>
    }
  } = options;

  <span class="keyword">return</span> (store) => (next) => (action) => {
    <span class="keyword">const</span> startTime = performance.<span class="function">now</span>();
    <span class="keyword">const</span> prevState = store.<span class="function">getState</span>();

    <span class="comment">// Create log group</span>
    <span class="keyword">const</span> logGroup = collapsed ? console.groupCollapsed : console.group;
    <span class="keyword">const</span> time = <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toLocaleTimeString</span>();
    <span class="keyword">const</span> title = <span class="string">`action ${action.type} @ ${time}`</span>;

    <span class="keyword">try</span> {
      <span class="function">logGroup</span>(<span class="string">`%c ${title}`</span>, <span class="string">`color: ${colors.title}; font-weight: bold`</span>);
    } <span class="keyword">catch</span> (e) {
      console.<span class="function">log</span>(title);
    }

    <span class="comment">// Log previous state</span>
    console.<span class="function">log</span>(
      <span class="string">'%c prev state'</span>,
      <span class="string">`color: ${colors.prevState}; font-weight: bold`</span>,
      prevState
    );

    <span class="comment">// Log action</span>
    console.<span class="function">log</span>(
      <span class="string">'%c action'</span>,
      <span class="string">`color: ${colors.action}; font-weight: bold`</span>,
      action
    );

    <span class="comment">// Execute action</span>
    <span class="keyword">const</span> result = <span class="function">next</span>(action);
    <span class="keyword">const</span> nextState = store.<span class="function">getState</span>();

    <span class="comment">// Log next state</span>
    console.<span class="function">log</span>(
      <span class="string">'%c next state'</span>,
      <span class="string">`color: ${colors.nextState}; font-weight: bold`</span>,
      nextState
    );

    <span class="comment">// Log duration</span>
    <span class="keyword">if</span> (duration) {
      <span class="keyword">const</span> endTime = performance.<span class="function">now</span>();
      <span class="keyword">const</span> took = endTime - startTime;
      console.<span class="function">log</span>(<span class="string">`%c duration: ${took.toFixed(2)}ms`</span>, <span class="string">'color: #999'</span>);
    }

    console.<span class="function">groupEnd</span>();

    <span class="keyword">return</span> result;
  };
};

<span class="comment">// Advanced Error Handler with Reporting</span>
<span class="keyword">const</span> <span class="function">createErrorHandler</span> = (errorReporter) => {
  <span class="keyword">return</span> (store) => (next) => (action) => {
    <span class="keyword">try</span> {
      <span class="keyword">return</span> <span class="function">next</span>(action);
    } <span class="keyword">catch</span> (error) {
      <span class="comment">// Log error details</span>
      console.<span class="function">error</span>(<span class="string">'Error in action:'</span>, {
        action,
        error,
        state: store.<span class="function">getState</span>(),
        timestamp: <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>()
      });

      <span class="comment">// Report to error tracking service (Sentry, Bugsnag, etc.)</span>
      <span class="keyword">if</span> (errorReporter) {
        <span class="function">errorReporter</span>.<span class="function">captureException</span>(error, {
          extra: {
            action: action.type,
            payload: action.payload,
            state: store.<span class="function">getState</span>()
          }
        });
      }

      <span class="comment">// Dispatch error action</span>
      store.<span class="function">dispatch</span>({
        type: <span class="string">'@@ERROR/GLOBAL_ERROR'</span>,
        payload: {
          message: error.message,
          stack: error.stack,
          action: action.type
        }
      });

      <span class="comment">// Re-throw in development</span>
      <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) {
        <span class="keyword">throw</span> error;
      }

      <span class="keyword">return</span> error;
    }
  };
};

<span class="comment">// Usage</span>
<span class="keyword">import</span> * <span class="keyword">as</span> Sentry <span class="keyword">from</span> <span class="string">'@sentry/browser'</span>;

<span class="keyword">const</span> store = <span class="function">configureStore</span>({
  reducer: rootReducer,
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware()
      .<span class="function">concat</span>(<span class="function">createLogger</span>())
      .<span class="function">concat</span>(<span class="function">createErrorHandler</span>(Sentry))
});
                </div>
            </div>

            <!-- Reselect Section -->
            <div class="section">
                <h2>4Ô∏è‚É£ Reselect - Optimized Selectors</h2>

                <div class="definition">
                    <strong>Reselect:</strong> A library for creating memoized selector functions. Selectors can compute derived data, allowing Redux to store the minimal possible state while efficiently computing derived values on-demand.
                </div>

                <div class="hinglish">
                    <p><strong>Problem kya hai?</strong> Jab bhi state change hoti hai, sabhi connected components re-render hote hain. Agar aap complex calculations kar rahe ho (filtering, sorting, aggregating), toh ye calculations har render pe dobara hoti hain - bahut slow! üêå</p>
                    <p><strong>Solution:</strong> Reselect! Ye selectors ko "memoize" karta hai - matlab agar input same hai, toh cached result return karta hai. Calculation dobara nahi hoti! ‚ö°</p>
                </div>

                <div class="memoization-visual">
                    <div class="memo-box">
                        <h4>‚ùå Without Memoization</h4>
                        <p style="margin: 10px 0;">Every render:</p>
                        <ul style="text-align: left; margin-left: 20px; font-size: 14px;">
                            <li>Filter array</li>
                            <li>Sort results</li>
                            <li>Calculate totals</li>
                        </ul>
                        <span class="badge badge-error">Slow üêå</span>
                    </div>

                    <div class="memo-box cached">
                        <h4>‚úÖ With Memoization</h4>
                        <p style="margin: 10px 0;">Only when input changes:</p>
                        <ul style="text-align: left; margin-left: 20px; font-size: 14px;">
                            <li>Check cache</li>
                            <li>Return cached result</li>
                            <li>No recalculation!</li>
                        </ul>
                        <span class="badge badge-success">Fast ‚ö°</span>
                    </div>
                </div>

                <div class="demo-box">
                    <h3>üéØ Live Demo: Reselect Performance</h3>
                    <p>Dekho memoization se kitna performance improve hota hai!</p>

                    <div style="margin: 20px 0;">
                        <button class="btn" onclick="runWithoutMemo()">‚ùå Without Memoization</button>
                        <button class="btn btn-success" onclick="runWithMemo()">‚úÖ With Memoization</button>
                        <button class="btn btn-warning" onclick="resetPerformance()">üîÑ Reset</button>
                    </div>

                    <div class="selector-stats">
                        <div class="stat-box">
                            <div class="stat-value" id="without-memo-time">0</div>
                            <div class="stat-label">Without Memo (ms)</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="with-memo-time">0</div>
                            <div class="stat-label">With Memo (ms)</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="performance-gain">0</div>
                            <div class="stat-label">Performance Gain (%)</div>
                        </div>
                    </div>

                    <div class="performance-meter">
                        <h4>Execution Time Comparison</h4>
                        <div>
                            <p style="margin: 10px 0;">Without Memoization:</p>
                            <div class="meter-bar">
                                <div class="meter-fill slow" id="meter-without" style="width: 0%">0ms</div>
                            </div>
                        </div>
                        <div>
                            <p style="margin: 10px 0;">With Memoization:</p>
                            <div class="meter-bar">
                                <div class="meter-fill" id="meter-with" style="width: 0%">0ms</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="code-block">
<span class="comment">// Reselect Basic Usage</span>
<span class="keyword">import</span> { createSelector } <span class="keyword">from</span> <span class="string">'reselect'</span>;

<span class="comment">// Input selectors - Simple functions</span>
<span class="keyword">const</span> <span class="function">selectTodos</span> = (state) => state.todos;
<span class="keyword">const</span> <span class="function">selectFilter</span> = (state) => state.filter;

<span class="comment">// Memoized selector - Complex computation</span>
<span class="keyword">const</span> selectFilteredTodos = <span class="function">createSelector</span>(
  [selectTodos, selectFilter],  <span class="comment">// Input selectors</span>
  (todos, filter) => {            <span class="comment">// Result function</span>
    console.<span class="function">log</span>(<span class="string">'Computing filtered todos...'</span>);
    
    <span class="keyword">switch</span> (filter) {
      <span class="keyword">case</span> <span class="string">'COMPLETED'</span>:
        <span class="keyword">return</span> todos.<span class="function">filter</span>(t => t.completed);
      <span class="keyword">case</span> <span class="string">'ACTIVE'</span>:
        <span class="keyword">return</span> todos.<span class="function">filter</span>(t => !t.completed);
      <span class="keyword">default</span>:
        <span class="keyword">return</span> todos;
    }
  }
);

<span class="comment">// Use in component</span>
<span class="keyword">const</span> todos = <span class="function">useSelector</span>(selectFilteredTodos);
<span class="comment">// Agar todos aur filter same hain, cached result milega!</span>
                </div>

                <div class="code-block">
<span class="comment">// Advanced Reselect Patterns</span>

<span class="comment">// 1. Chaining Selectors</span>
<span class="keyword">const</span> selectCompletedTodos = <span class="function">createSelector</span>(
  [selectTodos],
  (todos) => todos.<span class="function">filter</span>(t => t.completed)
);

<span class="keyword">const</span> selectCompletedTodoCount = <span class="function">createSelector</span>(
  [selectCompletedTodos],
  (completedTodos) => completedTodos.length
);

<span class="comment">// 2. Selector with Multiple Inputs</span>
<span class="keyword">const</span> selectVisibleTodosWithStats = <span class="function">createSelector</span>(
  [selectTodos, selectFilter, selectSearchTerm],
  (todos, filter, searchTerm) => {
    <span class="keyword">let</span> filtered = todos;
    
    <span class="comment">// Apply filter</span>
    <span class="keyword">if</span> (filter !== <span class="string">'ALL'</span>) {
      filtered = filtered.<span class="function">filter</span>(t => 
        filter === <span class="string">'COMPLETED'</span> ? t.completed : !t.completed
      );
    }
    
    <span class="comment">// Apply search</span>
    <span class="keyword">if</span> (searchTerm) {
      filtered = filtered.<span class="function">filter</span>(t => 
        t.text.<span class="function">toLowerCase</span>().<span class="function">includes</span>(searchTerm.<span class="function">toLowerCase</span>())
      );
    }
    
    <span class="keyword">return</span> {
      todos: filtered,
      total: filtered.length,
      completed: filtered.<span class="function">filter</span>(t => t.completed).length
    };
  }
);

<span class="comment">// 3. Parametric Selectors (with props)</span>
<span class="keyword">const</span> <span class="function">makeSelectTodoById</span> = () => {
  <span class="keyword">return</span> <span class="function">createSelector</span>(
    [selectTodos, (state, todoId) => todoId],
    (todos, todoId) => todos.<span class="function">find</span>(t => t.id === todoId)
  );
};

<span class="comment">// Usage in component</span>
<span class="keyword">const</span> selectTodoById = <span class="function">useMemo</span>(makeSelectTodoById, []);
<span class="keyword">const</span> todo = <span class="function">useSelector</span>(state => <span class="function">selectTodoById</span>(state, todoId));

<span class="comment">// 4. Selector with Expensive Computation</span>
<span class="keyword">const</span> selectSortedAndGroupedTodos = <span class="function">createSelector</span>(
  [selectTodos],
  (todos) => {
    <span class="comment">// Expensive operations</span>
    <span class="keyword">const</span> sorted = [...todos].<span class="function">sort</span>((a, b) => 
      <span class="keyword">new</span> <span class="function">Date</span>(b.createdAt) - <span class="keyword">new</span> <span class="function">Date</span>(a.createdAt)
    );
    
    <span class="keyword">const</span> grouped = sorted.<span class="function">reduce</span>((acc, todo) => {
      <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="function">Date</span>(todo.createdAt).<span class="function">toDateString</span>();
      <span class="keyword">if</span> (!acc[date]) acc[date] = [];
      acc[date].<span class="function">push</span>(todo);
      <span class="keyword">return</span> acc;
    }, {});
    
    <span class="keyword">return</span> grouped;
  }
);

<span class="comment">// 5. Selector Factory for Multiple Instances</span>
<span class="keyword">const</span> <span class="function">makeSelectUserTodos</span> = () => {
  <span class="keyword">return</span> <span class="function">createSelector</span>(
    [selectTodos, (state, userId) => userId],
    (todos, userId) => todos.<span class="function">filter</span>(t => t.userId === userId)
  );
};
                </div>

                <div class="comparison-table">
                    <thead>
                        <tr>
                            <th>Scenario</th>
                            <th>Without Reselect</th>
                            <th>With Reselect</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>State unchanged</strong></td>
                            <td>Recalculates every time</td>
                            <td>Returns cached result</td>
                        </tr>
                        <tr>
                            <td><strong>Unrelated state change</strong></td>
                            <td>Recalculates unnecessarily</td>
                            <td>Returns cached result</td>
                        </tr>
                        <tr>
                            <td><strong>Input changed</strong></td>
                            <td>Recalculates</td>
                            <td>Recalculates (expected)</td>
                        </tr>
                        <tr>
                            <td><strong>Performance</strong></td>
                            <td>Slow with complex logic</td>
                            <td>Fast with memoization</td>
                        </tr>
                        <tr>
                            <td><strong>Memory</strong></td>
                            <td>No extra memory</td>
                            <td>Stores last result</td>
                        </tr>
                    </tbody>
                </table>

                <div class="pro-tip">
                    Reselect sirf last result cache karta hai. Agar aapko multiple results cache karne hain (different props ke liye), toh re-reselect library use karo jo LRU cache provide karti hai!
                </div>
            </div>

            <!-- Best Practices Section -->
            <div class="section">
                <h2>5Ô∏è‚É£ Middleware & Optimization Best Practices</h2>

                <div class="grid">
                    <div class="card">
                        <h3>1. ‚úÖ Middleware Order</h3>
                        <p>Sahi order mein apply karo</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="comment">// Correct order</span>
<span class="function">applyMiddleware</span>(
  logger,      <span class="comment">// First</span>
  thunk,       <span class="comment">// Then</span>
  errorHandler <span class="comment">// Last</span>
)
                        </div>
                    </div>

                    <div class="card">
                        <h3>2. ‚úÖ Conditional Middleware</h3>
                        <p>Development vs Production</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="keyword">const</span> middleware = [thunk];
<span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) {
  middleware.<span class="function">push</span>(logger);
}
                        </div>
                    </div>

                    <div class="card">
                        <h3>3. ‚úÖ Selector Composition</h3>
                        <p>Chote selectors se bade banao</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="keyword">const</span> selectA = state => state.a;
<span class="keyword">const</span> selectB = <span class="function">createSelector</span>(
  [selectA],
  a => <span class="function">compute</span>(a)
);
                        </div>
                    </div>

                    <div class="card">
                        <h3>4. ‚úÖ Avoid Over-Memoization</h3>
                        <p>Simple selectors ko memoize mat karo</p>
                        <div class="code-block" style="font-size: 11px; margin-top: 10px;">
<span class="comment">// ‚ùå Unnecessary</span>
<span class="keyword">const</span> selectUser = <span class="function">createSelector</span>(
  state => state.user,
  user => user
);

<span class="comment">// ‚úÖ Simple is better</span>
<span class="keyword">const</span> selectUser = state => state.user;
                        </div>
                    </div>
                </div>

                <div class="highlight-box">
                    <strong>üéØ Performance Optimization Checklist:</strong>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>‚úÖ Use Reselect for expensive computations</li>
                        <li>‚úÖ Keep middleware lightweight</li>
                        <li>‚úÖ Avoid synchronous heavy operations in middleware</li>
                        <li>‚úÖ Use proper error boundaries</li>
                        <li>‚úÖ Monitor middleware execution time</li>
                        <li>‚úÖ Cache API responses when possible</li>
                        <li>‚úÖ Debounce/throttle frequent actions</li>
                    </ul>
                </div>
            </div>

            <!-- Interview Questions Section -->
            <div class="interview-section">
                <h2>üéØ Interview Questions (Basic to Advanced)</h2>
                <p style="margin-bottom: 20px;">Click on each question to reveal the answer</p>

                <div class="question" onclick="toggleAnswer(this)">
                    <h4>
                        Q1. Redux Middleware kya hai aur kaise kaam karta hai? (Basic)
                        <span class="question-icon">‚ñº</span>
                    </h4>
                    <div class="answer">
                        <p><strong>Answer:</strong></p>
                        <p><strong>Middleware:</strong> Ek function jo action dispatch hone aur reducer tak pahunchne ke beech mein execute hota hai.</p>
                        
                        <p><strong>Signature:</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 13px;">
<span class="keyword">const</span> middleware = (store) => (next) => (action) => {
  <span class="comment">// Before reducer</span>
  console.<span class="function">log</span>(<span class="string">'Action:'</span>, action);
  
  <span class="comment">// Call next middleware/reducer</span>
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  
  <span class="comment">// After reducer</span>
  console.<span class="function">log</span>(<span class="string">'New State:'</span>, store.<span class="function">getState</span>());
  
  <span class="keyword">return</span> result;
};
                        </div>

                        <p><strong>Kaise Kaam Karta Hai:</strong></p>
                        <ol style="margin-left: 25px;">
                            <li><strong>store:</strong> Redux store ka access (getState, dispatch)</li>
                            <li><strong>next:</strong> Agle middleware ya reducer ko call karne ke liye</li>
                            <li><strong>action:</strong> Current action object</li>
                        </ol>

                        <p><strong>Use Cases:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li>Logging (actions aur state changes)</li>
                            <li>Async operations (API calls)</li>
                            <li>Error handling</li>
                            <li>Analytics tracking</li>
                            <li>Action transformation</li>
                        </ul>

                        <p><strong>Hinglish:</strong> Middleware ek checkpoint hai jo har action ko check karta hai. Aap action ko modify kar sakte ho, delay kar sakte ho, ya extra kaam kar sakte ho before reducer!</p>
                    </div>
                </div>

                <div class="question" onclick="toggleAnswer(this)">
                    <h4>
                        Q2. Redux Thunk kya hai aur kab use karte hain? (Basic)
                        <span class="question-icon">‚ñº</span>
                    </h4>
                    <div class="answer">
                        <p><strong>Answer:</strong></p>
                        <p><strong>Redux Thunk:</strong> Ek middleware jo aapko action creators se functions return karne deta hai instead of plain objects.</p>

                        <p><strong>Normal Action Creator:</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 13px;">
<span class="comment">// Returns object</span>
<span class="keyword">const</span> <span class="function">increment</span> = () => ({
  type: <span class="string">'INCREMENT'</span>
});
                        </div>

                        <p><strong>Thunk Action Creator:</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 13px;">
<span class="comment">// Returns function</span>
<span class="keyword">const</span> <span class="function">incrementAsync</span> = () => {
  <span class="keyword">return</span> (dispatch, getState) => {
    <span class="function">setTimeout</span>(() => {
      <span class="function">dispatch</span>({ type: <span class="string">'INCREMENT'</span> });
    }, <span class="number">1000</span>);
  };
};
                        </div>

                        <p><strong>Kab Use Karein:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li><strong>API Calls:</strong> Async data fetching</li>
                            <li><strong>Delayed Actions:</strong> setTimeout/setInterval</li>
                            <li><strong>Conditional Dispatch:</strong> State check karke dispatch</li>
                            <li><strong>Multiple Dispatches:</strong> Ek action se multiple dispatches</li>
                        </ul>

                        <p><strong>Benefits:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li>Async logic ko action creators mein rakh sakte ho</li>
                            <li>Components clean rahte hain</li>
                            <li>Reusable async logic</li>
                            <li>Access to dispatch and getState</li>
                        </ul>

                        <p><strong>Hinglish:</strong> Thunk se aap functions return kar sakte ho jo async operations kar sakein. Ye API calls aur delayed actions ke liye perfect hai!</p>
                    </div>
                </div>

                <div class="question" onclick="toggleAnswer(this)">
                    <h4>
                        Q3. Custom middleware kaise banate hain? Example ke saath explain karo (Intermediate)
                        <span class="question-icon">‚ñº</span>
                    </h4>
                    <div class="answer">
                        <p><strong>Answer:</strong></p>
                        <p><strong>Custom Middleware Structure:</strong> Three nested functions (currying pattern)</p>

                        <div class="code-block" style="margin: 15px 0; font-size: 12px;">
<span class="comment">// Template</span>
<span class="keyword">const</span> <span class="function">myMiddleware</span> = (store) => (next) => (action) => {
  <span class="comment">// Your logic here</span>
  <span class="keyword">return</span> <span class="function">next</span>(action);
};

<span class="comment">// Example 1: Logger Middleware</span>
<span class="keyword">const</span> <span class="function">logger</span> = (store) => (next) => (action) => {
  console.<span class="function">group</span>(action.type);
  console.<span class="function">log</span>(<span class="string">'Previous State:'</span>, store.<span class="function">getState</span>());
  console.<span class="function">log</span>(<span class="string">'Action:'</span>, action);
  
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  
  console.<span class="function">log</span>(<span class="string">'Next State:'</span>, store.<span class="function">getState</span>());
  console.<span class="function">groupEnd</span>();
  
  <span class="keyword">return</span> result;
};

<span class="comment">// Example 2: Analytics Middleware</span>
<span class="keyword">const</span> <span class="function">analytics</span> = (store) => (next) => (action) => {
  <span class="comment">// Track specific actions</span>
  <span class="keyword">if</span> (action.type.<span class="function">startsWith</span>(<span class="string">'USER_'</span>)) {
    <span class="function">trackEvent</span>({
      event: action.type,
      userId: store.<span class="function">getState</span>().user.id,
      timestamp: Date.<span class="function">now</span>()
    });
  }
  
  <span class="keyword">return</span> <span class="function">next</span>(action);
};

<span class="comment">// Example 3: API Middleware</span>
<span class="keyword">const</span> <span class="function">api</span> = (store) => (next) => (action) => {
  <span class="keyword">if</span> (action.type !== <span class="string">'API_REQUEST'</span>) {
    <span class="keyword">return</span> <span class="function">next</span>(action);
  }
  
  <span class="keyword">const</span> { endpoint, method, body, onSuccess, onError } = action.payload;
  
  <span class="function">fetch</span>(endpoint, { method, body: JSON.<span class="function">stringify</span>(body) })
    .<span class="function">then</span>(res => res.<span class="function">json</span>())
    .<span class="function">then</span>(data => store.<span class="function">dispatch</span>(<span class="function">onSuccess</span>(data)))
    .<span class="function">catch</span>(error => store.<span class="function">dispatch</span>(<span class="function">onError</span>(error)));
};

<span class="comment">// Apply middleware</span>
<span class="keyword">const</span> store = <span class="function">createStore</span>(
  reducer,
  <span class="function">applyMiddleware</span>(logger, analytics, api)
);
                        </div>

                        <p><strong>Key Points:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li><strong>Always call next():</strong> Warna action reducer tak nahi pahunchega</li>
                            <li><strong>Return result:</strong> next() ka result return karo</li>
                            <li><strong>Order matters:</strong> Middleware order important hai</li>
                            <li><strong>Access store:</strong> getState() aur dispatch() use kar sakte ho</li>
                        </ul>

                        <p><strong>Hinglish:</strong> Custom middleware banana easy hai - teen nested functions banao aur apna logic add karo. next() call karna mat bhoolna!</p>
                    </div>
                </div>

                <div class="question" onclick="toggleAnswer(this)">
                    <h4>
                        Q4. Reselect kya hai aur memoization kaise kaam karta hai? (Intermediate)
                        <span class="question-icon">‚ñº</span>
                    </h4>
                    <div class="answer">
                        <p><strong>Answer:</strong></p>
                        <p><strong>Reselect:</strong> Library for creating memoized selectors jo derived data efficiently compute karti hai.</p>

                        <p><strong>Problem Without Memoization:</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 12px;">
<span class="comment">// Har render pe recalculate hota hai</span>
<span class="keyword">const</span> <span class="function">TodoList</span> = () => {
  <span class="keyword">const</span> todos = <span class="function">useSelector</span>(state => state.todos);
  
  <span class="comment">// Expensive computation - har render pe!</span>
  <span class="keyword">const</span> sortedTodos = todos
    .<span class="function">filter</span>(t => !t.completed)
    .<span class="function">sort</span>((a, b) => b.priority - a.priority);
  
  <span class="keyword">return</span> <span class="comment">/* render */</span>;
};
                        </div>

                        <p><strong>Solution With Reselect:</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 12px;">
<span class="keyword">import</span> { createSelector } <span class="keyword">from</span> <span class="string">'reselect'</span>;

<span class="comment">// Input selector</span>
<span class="keyword">const</span> <span class="function">selectTodos</span> = state => state.todos;

<span class="comment">// Memoized selector</span>
<span class="keyword">const</span> selectSortedActiveTodos = <span class="function">createSelector</span>(
  [selectTodos],
  (todos) => {
    console.<span class="function">log</span>(<span class="string">'Computing...'</span>); <span class="comment">// Sirf jab todos change ho</span>
    <span class="keyword">return</span> todos
      .<span class="function">filter</span>(t => !t.completed)
      .<span class="function">sort</span>((a, b) => b.priority - a.priority);
  }
);

<span class="comment">// Use in component</span>
<span class="keyword">const</span> sortedTodos = <span class="function">useSelector</span>(selectSortedActiveTodos);
<span class="comment">// Agar todos same hain, cached result milega!</span>
                        </div>

                        <p><strong>How Memoization Works:</strong></p>
                        <ol style="margin-left: 25px;">
                            <li>Selector ko call karo with current state</li>
                            <li>Input selectors run hote hain</li>
                            <li>Check: Kya inputs previous call se same hain?</li>
                            <li>If YES: Return cached result (fast!)</li>
                            <li>If NO: Run computation, cache result, return</li>
                        </ol>

                        <p><strong>Benefits:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li><strong>Performance:</strong> Unnecessary recalculations avoid</li>
                            <li><strong>Composable:</strong> Selectors ko chain kar sakte ho</li>
                            <li><strong>Testable:</strong> Pure functions, easy to test</li>
                            <li><strong>Encapsulation:</strong> State shape ko hide kar sakte ho</li>
                        </ul>

                        <p><strong>When to Use:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li>Filtering/sorting large arrays</li>
                            <li>Complex calculations</li>
                            <li>Aggregating data from multiple slices</li>
                            <li>Transforming data for UI</li>
                        </ul>

                        <p><strong>Hinglish:</strong> Reselect ek smart cache hai. Agar input same hai toh calculation dobara nahi hoti - cached result return hota hai. Bahut fast! ‚ö°</p>
                    </div>
                </div>

                <div class="question" onclick="toggleAnswer(this)">
                    <h4>
                        Q5. Middleware execution order kaise kaam karta hai? Example se explain karo (Advanced)
                        <span class="question-icon">‚ñº</span>
                    </h4>
                    <div class="answer">
                        <p><strong>Answer:</strong></p>
                        <p><strong>Middleware Chain:</strong> Middleware ek chain ki tarah execute hote hain - pehle se last tak, phir wapas last se pehle tak.</p>

                        <div class="code-block" style="margin: 15px 0; font-size: 12px;">
<span class="comment">// Three middleware</span>
<span class="keyword">const</span> <span class="function">middleware1</span> = store => next => action => {
  console.<span class="function">log</span>(<span class="string">'1: Before'</span>);
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  console.<span class="function">log</span>(<span class="string">'1: After'</span>);
  <span class="keyword">return</span> result;
};

<span class="keyword">const</span> <span class="function">middleware2</span> = store => next => action => {
  console.<span class="function">log</span>(<span class="string">'2: Before'</span>);
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  console.<span class="function">log</span>(<span class="string">'2: After'</span>);
  <span class="keyword">return</span> result;
};

<span class="keyword">const</span> <span class="function">middleware3</span> = store => next => action => {
  console.<span class="function">log</span>(<span class="string">'3: Before'</span>);
  <span class="keyword">const</span> result = <span class="function">next</span>(action);
  console.<span class="function">log</span>(<span class="string">'3: After'</span>);
  <span class="keyword">return</span> result;
};

<span class="comment">// Apply in order</span>
<span class="function">applyMiddleware</span>(middleware1, middleware2, middleware3);

<span class="comment">// When action is dispatched:</span>
<span class="comment">// Output:</span>
<span class="comment">// 1: Before</span>
<span class="comment">// 2: Before</span>
<span class="comment">// 3: Before</span>
<span class="comment">// [Reducer executes]</span>
<span class="comment">// 3: After</span>
<span class="comment">// 2: After</span>
<span class="comment">// 1: After</span>
                        </div>

                        <p><strong>Execution Flow:</strong></p>
                        <ol style="margin-left: 25px;">
                            <li>Action dispatch hota hai</li>
                            <li>Middleware 1 execute hota hai (before next)</li>
                            <li>Middleware 2 execute hota hai (before next)</li>
                            <li>Middleware 3 execute hota hai (before next)</li>
                            <li>Reducer execute hota hai</li>
                            <li>Middleware 3 complete hota hai (after next)</li>
                            <li>Middleware 2 complete hota hai (after next)</li>
                            <li>Middleware 1 complete hota hai (after next)</li>
                        </ol>

                        <p><strong>Practical Example:</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 12px;">
<span class="comment">// Correct order for common middleware</span>
<span class="function">applyMiddleware</span>(
  logger,        <span class="comment">// 1. Log everything first</span>
  crashReporter, <span class="comment">// 2. Catch errors</span>
  thunk,         <span class="comment">// 3. Handle async actions</span>
  analytics      <span class="comment">// 4. Track after processing</span>
);

<span class="comment">// Why this order?</span>
<span class="comment">// - Logger sees all actions (even from thunks)</span>
<span class="comment">// - Crash reporter catches all errors</span>
<span class="comment">// - Thunk converts functions to actions</span>
<span class="comment">// - Analytics tracks final actions</span>
                        </div>

                        <p><strong>Common Mistakes:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li><strong>‚ùå Thunk after logger:</strong> Logger won't see thunk actions</li>
                            <li><strong>‚ùå Error handler last:</strong> Won't catch errors from other middleware</li>
                            <li><strong>‚ùå Not calling next():</strong> Chain breaks, reducer never executes</li>
                        </ul>

                        <p><strong>Hinglish:</strong> Middleware ek onion ki tarah hai - bahar se andar jaate ho, phir andar se bahar aate ho. Order bahut important hai!</p>
                    </div>
                </div>

                <div class="question" onclick="toggleAnswer(this)">
                    <h4>
                        Q6. Production-ready error handling middleware kaise implement karein? (Advanced)
                        <span class="question-icon">‚ñº</span>
                    </h4>
                    <div class="answer">
                        <p><strong>Answer:</strong></p>
                        <p><strong>Production Error Handler:</strong> Comprehensive error handling with reporting, recovery, and user feedback.</p>

                        <div class="code-block" style="margin: 15px 0; font-size: 11px;">
<span class="keyword">const</span> <span class="function">createErrorHandler</span> = (config = {}) => {
  <span class="keyword">const</span> {
    errorReporter = <span class="keyword">null</span>,  <span class="comment">// Sentry, Bugsnag, etc.</span>
    showUserError = <span class="keyword">true</span>,
    logErrors = <span class="keyword">true</span>,
    retryableActions = []
  } = config;

  <span class="keyword">return</span> (store) => (next) => (action) => {
    <span class="keyword">try</span> {
      <span class="comment">// Try to execute action</span>
      <span class="keyword">return</span> <span class="function">next</span>(action);
      
    } <span class="keyword">catch</span> (error) {
      <span class="comment">// 1. Log error details</span>
      <span class="keyword">if</span> (logErrors) {
        console.<span class="function">error</span>(<span class="string">'Redux Error:'</span>, {
          action: action.type,
          payload: action.payload,
          error: error.message,
          stack: error.stack,
          state: store.<span class="function">getState</span>(),
          timestamp: <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>()
        });
      }

      <span class="comment">// 2. Report to error tracking service</span>
      <span class="keyword">if</span> (errorReporter) {
        errorReporter.<span class="function">captureException</span>(error, {
          tags: {
            action: action.type,
            environment: process.env.NODE_ENV
          },
          extra: {
            payload: action.payload,
            state: store.<span class="function">getState</span>()
          },
          level: <span class="string">'error'</span>
        });
      }

      <span class="comment">// 3. Dispatch error action</span>
      store.<span class="function">dispatch</span>({
        type: <span class="string">'@@ERROR/GLOBAL_ERROR'</span>,
        payload: {
          message: error.message,
          action: action.type,
          recoverable: retryableActions.<span class="function">includes</span>(action.type)
        },
        error: <span class="keyword">true</span>
      });

      <span class="comment">// 4. Show user-friendly error</span>
      <span class="keyword">if</span> (showUserError) {
        store.<span class="function">dispatch</span>({
          type: <span class="string">'SHOW_NOTIFICATION'</span>,
          payload: {
            type: <span class="string">'error'</span>,
            message: <span class="string">'Something went wrong. Please try again.'</span>
          }
        });
      }

      <span class="comment">// 5. Retry logic for specific actions</span>
      <span class="keyword">if</span> (retryableActions.<span class="function">includes</span>(action.type)) {
        <span class="function">setTimeout</span>(() => {
          console.<span class="function">log</span>(<span class="string">'Retrying action:'</span>, action.type);
          store.<span class="function">dispatch</span>(action);
        }, <span class="number">2000</span>);
      }

      <span class="comment">// 6. Don't throw in production</span>
      <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) {
        <span class="keyword">throw</span> error;
      }

      <span class="keyword">return</span> error;
    }
  };
};

<span class="comment">// Usage with Sentry</span>
<span class="keyword">import</span> * <span class="keyword">as</span> Sentry <span class="keyword">from</span> <span class="string">'@sentry/react'</span>;

Sentry.<span class="function">init</span>({
  dsn: <span class="string">'your-sentry-dsn'</span>,
  environment: process.env.NODE_ENV
});

<span class="keyword">const</span> errorHandler = <span class="function">createErrorHandler</span>({
  errorReporter: Sentry,
  retryableActions: [<span class="string">'FETCH_DATA'</span>, <span class="string">'SAVE_DATA'</span>]
});

<span class="keyword">const</span> store = <span class="function">configureStore</span>({
  reducer: rootReducer,
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().<span class="function">concat</span>(errorHandler)
});
                        </div>

                        <p><strong>Key Features:</strong></p>
                        <ul style="margin-left: 25px;">
                            <li><strong>Comprehensive Logging:</strong> Action, state, timestamp</li>
                            <li><strong>Error Reporting:</strong> Integration with Sentry/Bugsnag</li>
                            <li><strong>User Feedback:</strong> Show friendly error messages</li>
                            <li><strong>Retry Logic:</strong> Automatic retry for specific actions</li>
                            <li><strong>Environment Aware:</strong> Different behavior for dev/prod</li>
                            <li><strong>State Recovery:</strong> Dispatch recovery actions</li>
                        </ul>

                        <p><strong>Hinglish:</strong> Production error handler ko comprehensive hona chahiye - errors ko log karo, report karo, user ko batao, aur possible ho toh recover karo!</p>
                    </div>
                </div>

                <div class="question" onclick="toggleAnswer(this)">
                    <h4>
                        Q7. Reselect mein parametric selectors kaise banate hain? Factory pattern explain karo (Expert)
                        <span class="question-icon">‚ñº</span>
                    </h4>
                    <div class="answer">
                        <p><strong>Answer:</strong></p>
                        <p><strong>Problem:</strong> Agar aapko props ke basis pe selector banana hai (e.g., specific user ID), toh simple createSelector kaam nahi karega kyunki har component instance ko apna memoized selector chahiye.</p>

                        <p><strong>Solution: Selector Factory Pattern</strong></p>

                        <div class="code-block" style="margin: 15px 0; font-size: 11px;">
<span class="comment">// ‚ùå Wrong: Shared selector (memoization breaks)</span>
<span class="keyword">const</span> selectUserById = <span class="function">createSelector</span>(
  [state => state.users, (state, userId) => userId],
  (users, userId) => users.<span class="function">find</span>(u => u.id === userId)
);

<span class="comment">// Problem: Multiple components with different IDs</span>
<span class="comment">// Component A: userId = 1</span>
<span class="comment">// Component B: userId = 2</span>
<span class="comment">// Memoization breaks because inputs keep changing!</span>

<span class="comment">// ‚úÖ Correct: Factory Pattern</span>
<span class="keyword">const</span> <span class="function">makeSelectUserById</span> = () => {
  <span class="keyword">return</span> <span class="function">createSelector</span>(
    [state => state.users, (state, userId) => userId],
    (users, userId) => {
      console.<span class="function">log</span>(<span class="string">'Computing user...'</span>);
      <span class="keyword">return</span> users.<span class="function">find</span>(u => u.id === userId);
    }
  );
};

<span class="comment">// Usage in component</span>
<span class="keyword">const</span> <span class="function">UserProfile</span> = ({ userId }) => {
  <span class="comment">// Create selector instance for this component</span>
  <span class="keyword">const</span> selectUserById = <span class="function">useMemo</span>(makeSelectUserById, []);
  
  <span class="comment">// Use the selector</span>
  <span class="keyword">const</span> user = <span class="function">useSelector</span>(state => 
    <span class="function">selectUserById</span>(state, userId)
  );
  
  <span class="keyword">return</span> &lt;div&gt;{user.name}&lt;/div&gt;;
};
                        </div>

                        <p><strong>Advanced: Multiple Parameters</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 11px;">
<span class="comment">// Factory with multiple parameters</span>
<span class="keyword">const</span> <span class="function">makeSelectFilteredTodos</span> = () => {
  <span class="keyword">return</span> <span class="function">createSelector</span>(
    [
      state => state.todos,
      (state, userId) => userId,
      (state, userId, filter) => filter
    ],
    (todos, userId, filter) => {
      console.<span class="function">log</span>(<span class="string">'Computing filtered todos...'</span>);
      
      <span class="keyword">let</span> filtered = todos.<span class="function">filter</span>(t => t.userId === userId);
      
      <span class="keyword">if</span> (filter === <span class="string">'completed'</span>) {
        filtered = filtered.<span class="function">filter</span>(t => t.completed);
      } <span class="keyword">else if</span> (filter === <span class="string">'active'</span>) {
        filtered = filtered.<span class="function">filter</span>(t => !t.completed);
      }
      
      <span class="keyword">return</span> filtered;
    }
  );
};

<span class="comment">// Usage</span>
<span class="keyword">const</span> <span class="function">TodoList</span> = ({ userId, filter }) => {
  <span class="keyword">const</span> selectFilteredTodos = <span class="function">useMemo</span>(
    makeSelectFilteredTodos, 
    []
  );
  
  <span class="keyword">const</span> todos = <span class="function">useSelector</span>(state => 
    <span class="function">selectFilteredTodos</span>(state, userId, filter)
  );
  
  <span class="keyword">return</span> <span class="comment">/* render */</span>;
};
                        </div>

                        <p><strong>Alternative: Re-Reselect (LRU Cache)</strong></p>
                        <div class="code-block" style="margin: 15px 0; font-size: 11px;">
<span class="keyword">import</span> createCachedSelector <span class="keyword">from</span> <span class="string">'re-reselect'</span>;

<span class="comment">// Automatically caches multiple results</span>
<span class="keyword">const</span> selectUserById = <span class="function">createCachedSelector</span>(
  [state => state.users, (state, userId) => userId],
  (users, userId) => users.<span class="function">find</span>(u => u.id === userId)
)(
  <span class="comment">// Key selector - cache key</span>
  (state, userId) => userId
);

<span class="comment">// No need for factory pattern!</span>
<span class="keyword">const</span> user = <span class="function">useSelector</span>(state => 
  <span class="function">selectUserById</span>(state, userId)
);
                        </div>

                        <p><strong>When to Use Each:</strong></p>
                        <table style="width: 100%; margin: 15px 0; border-collapse: collapse; font-size: 13px;">
                            <tr style="background: #f5f5f5;">
                                <th style="padding: 10px; border: 1px solid #ddd;">Pattern</th>
                                <th style="padding: 10px; border: 1px solid #ddd;">Use Case</th>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd;">Simple Selector</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">No props needed</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd;">Factory Pattern</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">Few instances, simple caching</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd;">Re-Reselect</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">Many instances, complex caching</td>
                            </tr>
                        </table>

                        <p><strong>Hinglish:</strong> Parametric selectors ke liye factory pattern use karo - har component instance ko apna memoized selector milega. Re-reselect library automatic LRU cache provide karti hai!</p>
                    </div>
                </div>
            </div>

            <!-- Summary Section -->
            <div class="section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                <h2>üìù Quick Summary</h2>
                <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 12px;">
                    <ul style="list-style: none; padding: 0; line-height: 2;">
                        <li>‚úÖ <strong>Middleware:</strong> Action aur reducer ke beech ka layer</li>
                        <li>‚úÖ <strong>Custom Middleware:</strong> Logging, analytics, error handling</li>
                        <li>‚úÖ <strong>Redux Thunk:</strong> Async operations ke liye functions return karo</li>
                        <li>‚úÖ <strong>Error Handling:</strong> Production-ready error tracking aur recovery</li>
                        <li>‚úÖ <strong>Reselect:</strong> Memoized selectors for performance</li>
                        <li>‚úÖ <strong>Middleware Order:</strong> Logger ‚Üí Error ‚Üí Thunk ‚Üí Analytics</li>
                        <li>‚úÖ <strong>Optimization:</strong> Expensive computations ko memoize karo</li>
                        <li>‚úÖ <strong>Factory Pattern:</strong> Parametric selectors ke liye</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let middlewareLogs = [];
        let thunkCounter = 0;
        let conditionalCounter = 0;

        // Middleware Demo
        function dispatchAction(actionType) {
            const timestamp = new Date().toLocaleTimeString();
            
            // Simulate middleware chain
            addLog(`[${timestamp}] üé¨ Action dispatched: ${actionType}`, 'action');
            
            setTimeout(() => {
                addLog(`[${timestamp}] ‚öôÔ∏è Logger Middleware: Logging action...`, 'info');
            }, 100);
            
            setTimeout(() => {
                addLog(`[${timestamp}] ‚öôÔ∏è Performance Middleware: Measuring time...`, 'info');
            }, 200);
            
            setTimeout(() => {
                if (actionType === 'ERROR_ACTION') {
                    addLog(`[${timestamp}] üö® Error Handler: Caught error!`, 'error');
                    addLog(`[${timestamp}] üìä Error reported to Sentry`, 'error');
                } else if (actionType === 'ASYNC_ACTION') {
                    addLog(`[${timestamp}] ‚è≥ Thunk Middleware: Handling async...`, 'info');
                    setTimeout(() => {
                        addLog(`[${timestamp}] ‚úÖ Async operation completed`, 'success');
                    }, 1000);
                } else {
                    addLog(`[${timestamp}] ‚úÖ Action processed successfully`, 'success');
                }
            }, 300);
            
            setTimeout(() => {
                addLog(`[${timestamp}] üì¶ Reducer: State updated`, 'state');
            }, 400);
        }

        function addLog(message, type = 'info') {
            const logsContainer = document.getElementById('middleware-logs');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type === 'error' ? 'log-error' : ''}`;
            
            let color = '#4caf50';
            if (type === 'action') color = '#82aaff';
            if (type === 'state') color = '#ffcb6b';
            if (type === 'error') color = '#f44336';
            
            logEntry.innerHTML = `<span style="color: ${color};">${message}</span>`;
            logsContainer.appendChild(logEntry);
            logsContainer.scrollTop = logsContainer.scrollHeight;
        }

        function clearLogs() {
            document.getElementById('middleware-logs').innerHTML = `
                <div class="log-entry">
                    <span class="log-time">[00:00:00]</span> 
                    <span style="color: #4caf50;">‚úì Logs cleared</span>
                </div>
            `;
        }

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Thunk Demos
        function simpleThunkDemo() {
            const display = document.getElementById('thunk-counter');
            display.style.opacity = '0.5';
            
            setTimeout(() => {
                thunkCounter++;
                display.textContent = thunkCounter;
                display.style.opacity = '1';
            }, 1000);
        }

        async function apiThunkDemo() {
            const status = document.getElementById('api-status');
            const result = document.getElementById('api-result');
            
            status.innerHTML = '<span class="badge badge-info">‚è≥ Loading...</span>';
            result.innerHTML = '';
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/users?_limit=3');
                const data = await response.json();
                
                status.innerHTML = '<span class="badge badge-success">‚úÖ Success!</span>';
                result.innerHTML = data.map(user => `
                    <div style="padding: 10px; margin: 5px 0; background: #f5f5f5; border-radius: 8px;">
                        <strong>${user.name}</strong> - ${user.email}
                    </div>
                `).join('');
            } catch (error) {
                status.innerHTML = '<span class="badge badge-error">‚ùå Error!</span>';
                result.innerHTML = `<p style="color: #f44336;">${error.message}</p>`;
            }
        }

        function conditionalThunkDemo() {
            const display = document.getElementById('conditional-counter');
            
            if (conditionalCounter % 2 === 0) {
                conditionalCounter++;
                display.textContent = conditionalCounter;
            } else {
                alert('Counter is odd! Increment skipped.');
            }
        }

        // Performance Demo
        function runWithoutMemo() {
            const start = performance.now();
            
            // Simulate expensive computation
            let result = 0;
            for (let i = 0; i < 10000000; i++) {
                result += Math.sqrt(i);
            }
            
            const end = performance.now();
            const time = (end - start).toFixed(2);
            
            document.getElementById('without-memo-time').textContent = time;
            document.getElementById('meter-without').style.width = '100%';
            document.getElementById('meter-without').textContent = time + 'ms';
            
            updatePerformanceGain();
        }

        function runWithMemo() {
            const start = performance.now();
            
            // Simulate cached result (instant)
            const cachedResult = 12345;
            
            const end = performance.now();
            const time = (end - start).toFixed(2);
            
            document.getElementById('with-memo-time').textContent = time;
            const withoutTime = parseFloat(document.getElementById('without-memo-time').textContent) || 100;
            const percentage = (parseFloat(time) / withoutTime) * 100;
            document.getElementById('meter-with').style.width = percentage + '%';
            document.getElementById('meter-with').textContent = time + 'ms';
            
            updatePerformanceGain();
        }

        function updatePerformanceGain() {
            const withoutTime = parseFloat(document.getElementById('without-memo-time').textContent);
            const withTime = parseFloat(document.getElementById('with-memo-time').textContent);
            
            if (withoutTime && withTime) {
                const gain = ((withoutTime - withTime) / withoutTime * 100).toFixed(1);
                document.getElementById('performance-gain').textContent = gain;
            }
        }

        function resetPerformance() {
            document.getElementById('without-memo-time').textContent = '0';
            document.getElementById('with-memo-time').textContent = '0';
            document.getElementById('performance-gain').textContent = '0';
            document.getElementById('meter-without').style.width = '0%';
            document.getElementById('meter-without').textContent = '0ms';
            document.getElementById('meter-with').style.width = '0%';
            document.getElementById('meter-with').textContent = '0ms';
        }

        // Interview Questions Toggle
        function toggleAnswer(element) {
            element.classList.toggle('active');
            const answer = element.querySelector('.answer');
            answer.classList.toggle('show');
        }

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>