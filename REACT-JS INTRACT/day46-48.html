<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication - Interactive Learning</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            animation: fadeInDown 0.8s ease;
        }

        header p {
            font-size: 1.3em;
            opacity: 0.95;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        nav {
            background: #f8f9fa;
            padding: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            border-bottom: 4px solid #667eea;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav button {
            padding: 12px 25px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: #667eea;
            font-size: 0.95em;
        }

        nav button:hover, nav button.active {
            background: #667eea;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .content {
            padding: 50px;
        }

        .section {
            display: none;
            animation: fadeIn 0.6s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        h2 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 4px solid #667eea;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        h3 {
            color: #764ba2;
            font-size: 1.8em;
            margin: 30px 0 20px 0;
        }

        .hinglish-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 6px solid #f39c12;
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.2);
        }

        .hinglish-box strong {
            color: #d35400;
        }

        .definition-box {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 6px solid #0652DD;
            box-shadow: 0 5px 15px rgba(9, 132, 227, 0.3);
        }

        .definition-box h3 {
            color: white;
            margin-top: 0;
        }

        .code-block {
            background: #2d3436;
            color: #dfe6e9;
            padding: 25px;
            border-radius: 15px;
            overflow-x: auto;
            margin: 25px 0;
            position: relative;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .code-block::before {
            content: 'CODE';
            position: absolute;
            top: 10px;
            right: 15px;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .interactive-demo {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 35px;
            border-radius: 20px;
            margin: 35px 0;
            border: 3px solid #667eea;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .demo-title {
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 25px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
        }

        .flow-step {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
            min-width: 150px;
            transition: all 0.3s;
            border: 3px solid transparent;
        }

        .flow-step:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }

        .flow-step .step-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-weight: bold;
            font-size: 1.2em;
        }

        .flow-arrow {
            font-size: 2.5em;
            color: #667eea;
            font-weight: bold;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: left;
            font-size: 1.1em;
        }

        .comparison-table td {
            padding: 20px;
            border-bottom: 1px solid #ecf0f1;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        button.primary-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s;
            margin: 8px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        button.primary-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
        }

        button.primary-btn:active {
            transform: translateY(0);
        }

        button.secondary-btn {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 15px 35px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s;
            margin: 8px;
        }

        button.secondary-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .auth-simulator {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .auth-panel {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .auth-panel h4 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .token-display {
            background: #2d3436;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 0.9em;
            word-break: break-all;
            margin: 15px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
            margin: 10px 5px;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }

        .status-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 2px solid #17a2b8;
        }

        .quiz-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 50px;
            border-radius: 20px;
            margin: 40px 0;
        }

        .question-card {
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin: 25px 0;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s;
        }

        .question-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #667eea;
            font-weight: bold;
            font-size: 1.2em;
        }

        .difficulty-badge {
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .easy { 
            background: #d4edda; 
            color: #155724; 
        }
        
        .medium { 
            background: #fff3cd; 
            color: #856404; 
        }
        
        .hard { 
            background: #f8d7da; 
            color: #721c24; 
        }

        .answer {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 3px solid #ecf0f1;
            display: none;
            color: #2d3436;
            line-height: 1.8;
        }

        .answer.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        .toggle-icon {
            font-size: 1.8em;
            transition: transform 0.3s;
        }

        .toggle-icon.rotated {
            transform: rotate(180deg);
        }

        .highlight {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
            color: #d35400;
        }

        .info-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 6px solid #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .info-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 25px 0;
        }

        .pros, .cons {
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .pros {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 6px solid #28a745;
        }

        .cons {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-left: 6px solid #dc3545;
        }

        .pros h4, .cons h4 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .storage-demo {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .storage-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s;
        }

        .storage-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }

        .storage-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .storage-card button {
            margin-top: 15px;
        }

        @media (max-width: 1024px) {
            .auth-simulator {
                grid-template-columns: 1fr;
            }

            .storage-demo {
                grid-template-columns: 1fr;
            }

            .pros-cons {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            .content {
                padding: 25px;
            }

            nav {
                flex-direction: column;
            }

            h2 {
                font-size: 1.8em;
            }

            .flow-diagram {
                flex-direction: column;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }
        }

        .protected-route-demo {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .route-status {
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê Authentication - Complete Guide</h1>
            <p>JWT, Cookies, Protected Routes aur bahut kuch!</p>
        </header>

        <nav>
            <button class="nav-btn active" onclick="showSection('intro')">Introduction</button>
            <button class="nav-btn" onclick="showSection('jwt')">JWT Authentication</button>
            <button class="nav-btn" onclick="showSection('storage')">Storage Options</button>
            <button class="nav-btn" onclick="showSection('flow')">Auth Flow</button>
            <button class="nav-btn" onclick="showSection('protected')">Protected Routes</button>
            <button class="nav-btn" onclick="showSection('refresh')">Refresh Tokens</button>
            <button class="nav-btn" onclick="showSection('providers')">Auth Providers</button>
            <button class="nav-btn" onclick="showSection('quiz')">Interview Questions</button>
        </nav>

        <div class="content">
            <!-- Introduction Section -->
            <div id="intro" class="section active">
                <h2>üéØ Authentication Kya Hai?</h2>
                
                <div class="hinglish-box">
                    <p><strong>Authentication</strong> ek process hai jisme hum verify karte hain ki user kaun hai. Jab aap kisi website pe login karte ho, toh wo authentication hai.</p>
                    <p style="margin-top: 15px;"><strong>Authorization</strong> ye decide karta hai ki authenticated user ko kya karne ki permission hai.</p>
                    <ul style="margin-left: 20px; margin-top: 15px;">
                        <li>üîë <strong>Authentication:</strong> "Tum kaun ho?" (Identity verification)</li>
                        <li>üö™ <strong>Authorization:</strong> "Tumhe kya karne ki permission hai?" (Access control)</li>
                    </ul>
                </div>

                <div class="definition-box">
                    <h3>Authentication Definition</h3>
                    <p><strong>Authentication</strong> is the process of verifying the identity of a user, device, or system. It ensures that the entity requesting access is who they claim to be.</p>
                    <p style="margin-top: 10px;"><strong>Authorization</strong> is the process of determining what permissions an authenticated user has and what resources they can access.</p>
                </div>

                <h3>Authentication Methods</h3>
                <div class="info-card">
                    <h4>üîê Common Authentication Methods:</h4>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>Session-based:</strong> Server pe session store hota hai</li>
                        <li><strong>Token-based (JWT):</strong> Client pe token store hota hai</li>
                        <li><strong>OAuth:</strong> Third-party providers (Google, Facebook)</li>
                        <li><strong>Multi-factor (MFA):</strong> Multiple verification steps</li>
                        <li><strong>Biometric:</strong> Fingerprint, Face ID</li>
                    </ul>
                </div>

                <h3>Why Authentication is Important?</h3>
                <div class="hinglish-box">
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li>üõ°Ô∏è <strong>Security:</strong> Unauthorized access se bachata hai</li>
                        <li>üë§ <strong>Personalization:</strong> User-specific content dikhata hai</li>
                        <li>üìä <strong>Data Protection:</strong> Sensitive data ko protect karta hai</li>
                        <li>üìù <strong>Audit Trail:</strong> Kon kya kar raha hai track karta hai</li>
                        <li>‚öñÔ∏è <strong>Compliance:</strong> Legal requirements fulfill karta hai</li>
                    </ul>
                </div>
            </div>

            <!-- JWT Section -->
            <div id="jwt" class="section">
                <h2>üé´ JWT Authentication</h2>
                
                <div class="hinglish-box">
                    <p><strong>JWT (JSON Web Token)</strong> ek compact aur self-contained token hai jo user ki identity aur claims ko securely transmit karta hai. Ye teen parts mein divided hota hai:</p>
                </div>

                <div class="definition-box">
                    <h3>JWT Definition</h3>
                    <p><strong>JSON Web Token (JWT)</strong> is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed.</p>
                </div>

                <h3>JWT Structure</h3>
                <div class="flow-diagram">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <h4 style="color: #e74c3c;">Header</h4>
                        <p>Algorithm & Token Type</p>
                    </div>
                    <div class="flow-arrow">.</div>
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <h4 style="color: #f39c12;">Payload</h4>
                        <p>User Data & Claims</p>
                    </div>
                    <div class="flow-arrow">.</div>
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <h4 style="color: #27ae60;">Signature</h4>
                        <p>Verification Hash</p>
                    </div>
                </div>

                <div class="code-block">
<code>// JWT Example
// Header (Base64 encoded)
{
  "alg": "HS256",
  "typ": "JWT"
}

// Payload (Base64 encoded)
{
  "sub": "1234567890",
  "name": "John Doe",
  "email": "john@example.com",
  "iat": 1516239022,
  "exp": 1516242622
}

// Signature
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret
)

// Final JWT Token:
// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiZW1haWwiOiJqb2huQGV4YW1wbGUuY29tIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</code>
                </div>

                <div class="hinglish-box">
                    <h3>JWT ke Important Claims:</h3>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>iss (Issuer):</strong> Token kisne issue kiya</li>
                        <li><strong>sub (Subject):</strong> User ka unique identifier</li>
                        <li><strong>aud (Audience):</strong> Token kis ke liye hai</li>
                        <li><strong>exp (Expiration):</strong> Token kab expire hoga</li>
                        <li><strong>iat (Issued At):</strong> Token kab issue hua</li>
                        <li><strong>nbf (Not Before):</strong> Token kab se valid hai</li>
                    </ul>
                </div>

                <h3>JWT Implementation</h3>
                <div class="code-block">
<code>// Backend - Creating JWT (Node.js)
const jwt = require('jsonwebtoken');

// Login endpoint
app.post('/api/login', async (req, res) => {
  const { email, password } = req.body;
  
  // Verify user credentials
  const user = await User.findOne({ email });
  if (!user || !await bcrypt.compare(password, user.password)) {
    return res.status(401).json({ error: 'Invalid credentials' });
  }
  
  // Create JWT token
  const token = jwt.sign(
    { 
      userId: user._id, 
      email: user.email,
      role: user.role 
    },
    process.env.JWT_SECRET,
    { expiresIn: '1h' }
  );
  
  res.json({ token, user: { id: user._id, email: user.email } });
});

// Middleware to verify JWT
const authenticateToken = (req, res, next) => {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1];
  
  if (!token) {
    return res.status(401).json({ error: 'Access token required' });
  }
  
  jwt.verify(token, process.env.JWT_SECRET, (err, user) => {
    if (err) {
      return res.status(403).json({ error: 'Invalid token' });
    }
    req.user = user;
    next();
  });
};

// Protected route
app.get('/api/profile', authenticateToken, (req, res) => {
  res.json({ user: req.user });
});</code>
                </div>

                <div class="code-block">
<code>// Frontend - Using JWT (React)
import axios from 'axios';

// Login function
const login = async (email, password) => {
  try {
    const response = await axios.post('/api/login', { email, password });
    const { token, user } = response.data;
    
    // Store token in localStorage
    localStorage.setItem('token', token);
    localStorage.setItem('user', JSON.stringify(user));
    
    return { success: true, user };
  } catch (error) {
    return { success: false, error: error.response.data.error };
  }
};

// Axios interceptor to add token to requests
axios.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// Fetch protected data
const fetchProfile = async () => {
  try {
    const response = await axios.get('/api/profile');
    return response.data;
  } catch (error) {
    if (error.response.status === 401) {
      // Token expired or invalid
      localStorage.removeItem('token');
      window.location.href = '/login';
    }
  }
};</code>
                </div>

                <div class="interactive-demo">
                    <div class="demo-title">üéÆ JWT Token Generator</div>
                    <div class="auth-simulator">
                        <div class="auth-panel">
                            <h4>User Information</h4>
                            <div class="form-group">
                                <label>User ID:</label>
                                <input type="text" id="jwt-userid" value="12345" />
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="email" id="jwt-email" value="user@example.com" />
                            </div>
                            <div class="form-group">
                                <label>Role:</label>
                                <input type="text" id="jwt-role" value="user" />
                            </div>
                            <button class="primary-btn" onclick="generateJWT()">üîë Generate JWT</button>
                        </div>
                        <div class="auth-panel">
                            <h4>Generated Token</h4>
                            <div id="jwt-output" class="token-display">
                                Click "Generate JWT" to create a token
                            </div>
                            <button class="secondary-btn" onclick="decodeJWT()">üîç Decode Token</button>
                        </div>
                    </div>
                    <div id="jwt-decoded" style="margin-top: 20px;"></div>
                </div>

                <div class="pros-cons">
                    <div class="pros">
                        <h4>‚úÖ JWT Advantages</h4>
                        <ul style="margin-left: 20px; line-height: 2;">
                            <li>Stateless - Server pe session store nahi karna</li>
                            <li>Scalable - Multiple servers ke saath easy</li>
                            <li>Cross-domain - Different domains pe kaam karta hai</li>
                            <li>Mobile-friendly - Apps ke liye perfect</li>
                            <li>Self-contained - Sab info token mein hai</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4>‚ùå JWT Disadvantages</h4>
                        <ul style="margin-left: 20px; line-height: 2;">
                            <li>Token size bada ho sakta hai</li>
                            <li>Revoke karna mushkil (logout issue)</li>
                            <li>XSS attacks ka risk (if stored in localStorage)</li>
                            <li>Token theft ho sakta hai</li>
                            <li>Sensitive data token mein nahi dalna chahiye</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Storage Options Section -->
            <div id="storage" class="section">
                <h2>üíæ Storage Options</h2>
                
                <div class="hinglish-box">
                    <p>Authentication tokens ko store karne ke teen main options hain. Har ek ke apne advantages aur disadvantages hain:</p>
                </div>

                <div class="storage-demo">
                    <div class="storage-card">
                        <h4>üì¶ LocalStorage</h4>
                        <p>Browser storage jo persist karta hai</p>
                        <button class="primary-btn" onclick="testStorage('local')">Test LocalStorage</button>
                    </div>
                    <div class="storage-card">
                        <h4>üç™ Cookies</h4>
                        <p>Server aur client dono access kar sakte hain</p>
                        <button class="primary-btn" onclick="testStorage('cookie')">Test Cookies</button>
                    </div>
                    <div class="storage-card">
                        <h4>üîí HttpOnly Cookies</h4>
                        <p>JavaScript se access nahi ho sakta (secure)</p>
                        <button class="primary-btn" onclick="testStorage('httponly')">Test HttpOnly</button>
                    </div>
                </div>

                <div id="storage-result" style="margin-top: 20px;"></div>

                <h3>Detailed Comparison</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>LocalStorage</th>
                            <th>Cookies</th>
                            <th>HttpOnly Cookies</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Capacity</strong></td>
                            <td>~5-10 MB</td>
                            <td>~4 KB per cookie</td>
                            <td>~4 KB per cookie</td>
                        </tr>
                        <tr>
                            <td><strong>Accessibility</strong></td>
                            <td>JavaScript only</td>
                            <td>JavaScript & Server</td>
                            <td>Server only</td>
                        </tr>
                        <tr>
                            <td><strong>Expiration</strong></td>
                            <td>Never (manual clear)</td>
                            <td>Configurable</td>
                            <td>Configurable</td>
                        </tr>
                        <tr>
                            <td><strong>Sent with Requests</strong></td>
                            <td>No (manual)</td>
                            <td>Yes (automatic)</td>
                            <td>Yes (automatic)</td>
                        </tr>
                        <tr>
                            <td><strong>XSS Protection</strong></td>
                            <td>‚ùå Vulnerable</td>
                            <td>‚ùå Vulnerable</td>
                            <td>‚úÖ Protected</td>
                        </tr>
                        <tr>
                            <td><strong>CSRF Protection</strong></td>
                            <td>‚úÖ Not vulnerable</td>
                            <td>‚ùå Vulnerable</td>
                            <td>‚ùå Vulnerable (needs CSRF token)</td>
                        </tr>
                        <tr>
                            <td><strong>Best For</strong></td>
                            <td>SPA, Mobile apps</td>
                            <td>Traditional web apps</td>
                            <td>Secure authentication</td>
                        </tr>
                    </tbody>
                </table>

                <div class="hinglish-box">
                    <h3>üîê Security Best Practices:</h3>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>HttpOnly Cookies:</strong> XSS attacks se bachne ke liye best option</li>
                        <li><strong>Secure Flag:</strong> HTTPS pe hi cookies send ho</li>
                        <li><strong>SameSite:</strong> CSRF attacks se protection</li>
                        <li><strong>Short Expiry:</strong> Tokens ko jaldi expire karo</li>
                        <li><strong>Refresh Tokens:</strong> Long-lived sessions ke liye use karo</li>
                    </ul>
                </div>

                <div class="code-block">
<code>// LocalStorage Implementation
// Storing token
localStorage.setItem('token', jwtToken);

// Retrieving token
const token = localStorage.getItem('token');

// Removing token (logout)
localStorage.removeItem('token');

// Adding to axios headers
axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;

// ============================================

// Cookie Implementation (Frontend)
// Setting cookie
document.cookie = `token=${jwtToken}; max-age=3600; path=/; secure; samesite=strict`;

// Reading cookie
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
}

// Deleting cookie
document.cookie = 'token=; max-age=0; path=/';

// ============================================

// HttpOnly Cookie Implementation (Backend)
// Setting HttpOnly cookie
app.post('/api/login', async (req, res) => {
  // ... verify credentials ...
  
  const token = jwt.sign({ userId: user._id }, process.env.JWT_SECRET);
  
  res.cookie('token', token, {
    httpOnly: true,      // JavaScript se access nahi ho sakta
    secure: true,        // Only HTTPS
    sameSite: 'strict',  // CSRF protection
    maxAge: 3600000      // 1 hour
  });
  
  res.json({ success: true });
});

// Reading HttpOnly cookie
app.get('/api/profile', (req, res) => {
  const token = req.cookies.token;
  // ... verify token ...
});</code>
                </div>

                <div class="info-card">
                    <h4>üéØ Which One to Choose?</h4>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>HttpOnly Cookies:</strong> Most secure option for web applications</li>
                        <li><strong>LocalStorage:</strong> Good for SPAs and mobile apps (with proper XSS protection)</li>
                        <li><strong>Regular Cookies:</strong> Avoid for sensitive tokens (XSS vulnerable)</li>
                    </ul>
                </div>
            </div>

            <!-- Auth Flow Section -->
            <div id="flow" class="section">
                <h2>üîÑ Authentication Flow</h2>
                
                <div class="hinglish-box">
                    <p>Authentication flow mein teen main operations hote hain: <strong>Signup</strong>, <strong>Login</strong>, aur <strong>Logout</strong>. Chaliye inhe detail mein samajhte hain:</p>
                </div>

                <h3>1. Signup Flow</h3>
                <div class="flow-diagram">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <h4>User Form</h4>
                        <p>Email, Password enter karta hai</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <h4>Validation</h4>
                        <p>Frontend validation</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <h4>API Call</h4>
                        <p>POST /api/signup</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <h4>Hash Password</h4>
                        <p>bcrypt se hash</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">5</div>
                        <h4>Save User</h4>
                        <p>Database mein store</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">6</div>
                        <h4>Generate JWT</h4>
                        <p>Token create karo</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">7</div>
                        <h4>Send Response</h4>
                        <p>Token + User data</p>
                    </div>
                </div>

                <div class="code-block">
<code>// Signup Implementation
// Backend (Node.js + Express)
const bcrypt = require('bcrypt');
const jwt = require('jsonwebtoken');

app.post('/api/signup', async (req, res) => {
  try {
    const { email, password, name } = req.body;
    
    // 1. Validate input
    if (!email || !password || !name) {
      return res.status(400).json({ error: 'All fields required' });
    }
    
    // 2. Check if user already exists
    const existingUser = await User.findOne({ email });
    if (existingUser) {
      return res.status(409).json({ error: 'User already exists' });
    }
    
    // 3. Hash password
    const saltRounds = 10;
    const hashedPassword = await bcrypt.hash(password, saltRounds);
    
    // 4. Create user
    const user = new User({
      email,
      password: hashedPassword,
      name
    });
    await user.save();
    
    // 5. Generate JWT
    const token = jwt.sign(
      { userId: user._id, email: user.email },
      process.env.JWT_SECRET,
      { expiresIn: '7d' }
    );
    
    // 6. Send response
    res.status(201).json({
      token,
      user: {
        id: user._id,
        email: user.email,
        name: user.name
      }
    });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});

// Frontend (React)
const signup = async (formData) => {
  try {
    const response = await axios.post('/api/signup', formData);
    const { token, user } = response.data;
    
    // Store token
    localStorage.setItem('token', token);
    localStorage.setItem('user', JSON.stringify(user));
    
    // Redirect to dashboard
    navigate('/dashboard');
  } catch (error) {
    setError(error.response.data.error);
  }
};</code>
                </div>

                <h3>2. Login Flow</h3>
                <div class="flow-diagram">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <h4>User Credentials</h4>
                        <p>Email, Password</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <h4>API Call</h4>
                        <p>POST /api/login</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <h4>Find User</h4>
                        <p>Database query</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <h4>Verify Password</h4>
                        <p>bcrypt.compare()</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">5</div>
                        <h4>Generate JWT</h4>
                        <p>Create token</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">6</div>
                        <h4>Send Token</h4>
                        <p>Return to client</p>
                    </div>
                </div>

                <div class="code-block">
<code>// Login Implementation
// Backend
app.post('/api/login', async (req, res) => {
  try {
    const { email, password } = req.body;
    
    // 1. Find user
    const user = await User.findOne({ email });
    if (!user) {
      return res.status(401).json({ error: 'Invalid credentials' });
    }
    
    // 2. Verify password
    const isValidPassword = await bcrypt.compare(password, user.password);
    if (!isValidPassword) {
      return res.status(401).json({ error: 'Invalid credentials' });
    }
    
    // 3. Generate tokens
    const accessToken = jwt.sign(
      { userId: user._id, email: user.email },
      process.env.JWT_SECRET,
      { expiresIn: '15m' }
    );
    
    const refreshToken = jwt.sign(
      { userId: user._id },
      process.env.REFRESH_TOKEN_SECRET,
      { expiresIn: '7d' }
    );
    
    // 4. Store refresh token in database
    user.refreshToken = refreshToken;
    await user.save();
    
    // 5. Send response
    res.json({
      accessToken,
      refreshToken,
      user: {
        id: user._id,
        email: user.email,
        name: user.name
      }
    });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});

// Frontend
const login = async (email, password) => {
  try {
    const response = await axios.post('/api/login', { email, password });
    const { accessToken, refreshToken, user } = response.data;
    
    localStorage.setItem('accessToken', accessToken);
    localStorage.setItem('refreshToken', refreshToken);
    localStorage.setItem('user', JSON.stringify(user));
    
    navigate('/dashboard');
  } catch (error) {
    setError(error.response.data.error);
  }
};</code>
                </div>

                <h3>3. Logout Flow</h3>
                <div class="flow-diagram">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <h4>User Clicks Logout</h4>
                        <p>Logout button</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <h4>API Call</h4>
                        <p>POST /api/logout</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <h4>Invalidate Token</h4>
                        <p>Remove from DB</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <h4>Clear Client Storage</h4>
                        <p>Remove tokens</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">5</div>
                        <h4>Redirect</h4>
                        <p>Go to login page</p>
                    </div>
                </div>

                <div class="code-block">
<code>// Logout Implementation
// Backend
app.post('/api/logout', authenticateToken, async (req, res) => {
  try {
    const userId = req.user.userId;
    
    // Remove refresh token from database
    await User.findByIdAndUpdate(userId, { refreshToken: null });
    
    res.json({ message: 'Logged out successfully' });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});

// Frontend
const logout = async () => {
  try {
    await axios.post('/api/logout');
    
    // Clear all stored data
    localStorage.removeItem('accessToken');
    localStorage.removeItem('refreshToken');
    localStorage.removeItem('user');
    
    // Redirect to login
    navigate('/login');
  } catch (error) {
    console.error('Logout error:', error);
  }
};</code>
                </div>

                <div class="interactive-demo">
                    <div class="demo-title">üéÆ Authentication Flow Simulator</div>
                    <div class="auth-simulator">
                        <div class="auth-panel">
                            <h4>Login Form</h4>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="email" id="login-email" value="user@example.com" />
                            </div>
                            <div class="form-group">
                                <label>Password:</label>
                                <input type="password" id="login-password" value="password123" />
                            </div>
                            <button class="primary-btn" onclick="simulateLogin()">üîê Login</button>
                            <button class="secondary-btn" onclick="simulateLogout()">üö™ Logout</button>
                        </div>
                        <div class="auth-panel">
                            <h4>Authentication Status</h4>
                            <div id="auth-status"></div>
                            <div id="auth-token" class="token-display" style="margin-top: 15px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Protected Routes Section -->
            <div id="protected" class="section">
                <h2>üõ°Ô∏è Protected Routes</h2>
                
                <div class="hinglish-box">
                    <p><strong>Protected Routes</strong> wo routes hain jo sirf authenticated users access kar sakte hain. Agar user logged in nahi hai, toh use login page pe redirect kar diya jata hai.</p>
                </div>

                <div class="definition-box">
                    <h3>Protected Routes Definition</h3>
                    <p><strong>Protected Routes</strong> are routes in an application that require authentication before access is granted. They ensure that only authorized users can view certain pages or perform specific actions.</p>
                </div>

                <h3>React Router Implementation</h3>
                <div class="code-block">
<code>// ProtectedRoute Component
import { Navigate } from 'react-router-dom';

const ProtectedRoute = ({ children }) => {
  const token = localStorage.getItem('accessToken');
  
  if (!token) {
    // User not authenticated, redirect to login
    return &lt;Navigate to="/login" replace /&gt;;
  }
  
  // User authenticated, render the protected component
  return children;
};

// Usage in App.js
import { BrowserRouter, Routes, Route } from 'react-router-dom';

function App() {
  return (
    &lt;BrowserRouter&gt;
      &lt;Routes&gt;
        {/* Public routes */}
        &lt;Route path="/login" element={&lt;Login /&gt;} /&gt;
        &lt;Route path="/signup" element={&lt;Signup /&gt;} /&gt;
        
        {/* Protected routes */}
        &lt;Route 
          path="/dashboard" 
          element={
            &lt;ProtectedRoute&gt;
              &lt;Dashboard /&gt;
            &lt;/ProtectedRoute&gt;
          } 
        /&gt;
        
        &lt;Route 
          path="/profile" 
          element={
            &lt;ProtectedRoute&gt;
              &lt;Profile /&gt;
            &lt;/ProtectedRoute&gt;
          } 
        /&gt;
        
        &lt;Route 
          path="/settings" 
          element={
            &lt;ProtectedRoute&gt;
              &lt;Settings /&gt;
            &lt;/ProtectedRoute&gt;
          } 
        /&gt;
      &lt;/Routes&gt;
    &lt;/BrowserRouter&gt;
  );
}</code>
                </div>

                <h3>Advanced Protected Route with Role-Based Access</h3>
                <div class="code-block">
<code>// Advanced ProtectedRoute with roles
const ProtectedRoute = ({ children, requiredRole }) => {
  const token = localStorage.getItem('accessToken');
  const user = JSON.parse(localStorage.getItem('user') || '{}');
  
  // Check if user is authenticated
  if (!token) {
    return &lt;Navigate to="/login" replace /&gt;;
  }
  
  // Check if user has required role
  if (requiredRole && user.role !== requiredRole) {
    return &lt;Navigate to="/unauthorized" replace /&gt;;
  }
  
  return children;
};

// Usage with roles
&lt;Route 
  path="/admin" 
  element={
    &lt;ProtectedRoute requiredRole="admin"&gt;
      &lt;AdminPanel /&gt;
    &lt;/ProtectedRoute&gt;
  } 
/&gt;

&lt;Route 
  path="/moderator" 
  element={
    &lt;ProtectedRoute requiredRole="moderator"&gt;
      &lt;ModeratorPanel /&gt;
    &lt;/ProtectedRoute&gt;
  } 
/&gt;</code>
                </div>

                <h3>Context-Based Authentication</h3>
                <div class="code-block">
<code>// AuthContext.js
import { createContext, useContext, useState, useEffect } from 'react';

const AuthContext = createContext();

export const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    // Check if user is logged in on mount
    const token = localStorage.getItem('accessToken');
    const userData = localStorage.getItem('user');
    
    if (token && userData) {
      setUser(JSON.parse(userData));
    }
    setLoading(false);
  }, []);
  
  const login = async (email, password) => {
    const response = await axios.post('/api/login', { email, password });
    const { accessToken, user } = response.data;
    
    localStorage.setItem('accessToken', accessToken);
    localStorage.setItem('user', JSON.stringify(user));
    setUser(user);
  };
  
  const logout = () => {
    localStorage.removeItem('accessToken');
    localStorage.removeItem('user');
    setUser(null);
  };
  
  return (
    &lt;AuthContext.Provider value={{ user, login, logout, loading }}&gt;
      {children}
    &lt;/AuthContext.Provider&gt;
  );
};

export const useAuth = () => useContext(AuthContext);

// ProtectedRoute using Context
const ProtectedRoute = ({ children }) => {
  const { user, loading } = useAuth();
  
  if (loading) {
    return &lt;div&gt;Loading...&lt;/div&gt;;
  }
  
  if (!user) {
    return &lt;Navigate to="/login" replace /&gt;;
  }
  
  return children;
};</code>
                </div>

                <div class="interactive-demo">
                    <div class="demo-title">üéÆ Protected Route Simulator</div>
                    <div class="protected-route-demo">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <button class="primary-btn" onclick="accessProtectedRoute('dashboard')">
                                üìä Access Dashboard
                            </button>
                            <button class="primary-btn" onclick="accessProtectedRoute('profile')">
                                üë§ Access Profile
                            </button>
                            <button class="primary-btn" onclick="accessProtectedRoute('admin')">
                                üîê Access Admin Panel
                            </button>
                        </div>
                        <div id="route-access-result" class="route-status"></div>
                    </div>
                </div>

                <div class="hinglish-box">
                    <h3>üéØ Best Practices for Protected Routes:</h3>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>Token Validation:</strong> Har request pe token verify karo</li>
                        <li><strong>Loading States:</strong> Authentication check hone tak loading dikhao</li>
                        <li><strong>Redirect Logic:</strong> Login ke baad original page pe redirect karo</li>
                        <li><strong>Role-Based Access:</strong> Different roles ke liye different access</li>
                        <li><strong>Error Handling:</strong> Token expire hone pe gracefully handle karo</li>
                    </ul>
                </div>
            </div>

            <!-- Refresh Tokens Section -->
            <div id="refresh" class="section">
                <h2>üîÑ Refresh Tokens</h2>
                
                <div class="hinglish-box">
                    <p><strong>Refresh Tokens</strong> long-lived tokens hote hain jo new access tokens generate karne ke liye use hote hain. Ye security aur user experience dono ko balance karte hain.</p>
                </div>

                <div class="definition-box">
                    <h3>Refresh Token Definition</h3>
                    <p><strong>Refresh Token</strong> is a long-lived token used to obtain new access tokens without requiring the user to log in again. It provides a balance between security (short-lived access tokens) and user experience (no frequent logins).</p>
                </div>

                <h3>Why Use Refresh Tokens?</h3>
                <div class="info-card">
                    <h4>üéØ Benefits:</h4>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>Security:</strong> Access tokens short-lived hote hain (15 min)</li>
                        <li><strong>User Experience:</strong> User ko baar-baar login nahi karna padta</li>
                        <li><strong>Revocation:</strong> Refresh tokens ko easily revoke kar sakte hain</li>
                        <li><strong>Session Management:</strong> Long sessions maintain kar sakte hain</li>
                    </ul>
                </div>

                <h3>Token Flow Diagram</h3>
                <div class="flow-diagram">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <h4>Login</h4>
                        <p>Access + Refresh Token milta hai</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <h4>API Calls</h4>
                        <p>Access Token use karo</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <h4>Token Expires</h4>
                        <p>401 Unauthorized</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <h4>Refresh Request</h4>
                        <p>Refresh Token bhejo</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">5</div>
                        <h4>New Access Token</h4>
                        <p>Naya token milta hai</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-step">
                        <div class="step-number">6</div>
                        <h4>Retry Request</h4>
                        <p>Original request retry</p>
                    </div>
                </div>

                <div class="code-block">
<code>// Backend - Refresh Token Implementation
app.post('/api/refresh', async (req, res) => {
  try {
    const { refreshToken } = req.body;
    
    if (!refreshToken) {
      return res.status(401).json({ error: 'Refresh token required' });
    }
    
    // Verify refresh token
    const decoded = jwt.verify(refreshToken, process.env.REFRESH_TOKEN_SECRET);
    
    // Find user and check if refresh token matches
    const user = await User.findById(decoded.userId);
    if (!user || user.refreshToken !== refreshToken) {
      return res.status(403).json({ error: 'Invalid refresh token' });
    }
    
    // Generate new access token
    const newAccessToken = jwt.sign(
      { userId: user._id, email: user.email },
      process.env.JWT_SECRET,
      { expiresIn: '15m' }
    );
    
    res.json({ accessToken: newAccessToken });
  } catch (error) {
    res.status(403).json({ error: 'Invalid refresh token' });
  }
});

// Optional: Rotate refresh token for extra security
app.post('/api/refresh-rotate', async (req, res) => {
  try {
    const { refreshToken } = req.body;
    
    // Verify old refresh token
    const decoded = jwt.verify(refreshToken, process.env.REFRESH_TOKEN_SECRET);
    const user = await User.findById(decoded.userId);
    
    if (!user || user.refreshToken !== refreshToken) {
      return res.status(403).json({ error: 'Invalid refresh token' });
    }
    
    // Generate new access token
    const newAccessToken = jwt.sign(
      { userId: user._id, email: user.email },
      process.env.JWT_SECRET,
      { expiresIn: '15m' }
    );
    
    // Generate new refresh token
    const newRefreshToken = jwt.sign(
      { userId: user._id },
      process.env.REFRESH_TOKEN_SECRET,
      { expiresIn: '7d' }
    );
    
    // Update refresh token in database
    user.refreshToken = newRefreshToken;
    await user.save();
    
    res.json({ 
      accessToken: newAccessToken,
      refreshToken: newRefreshToken 
    });
  } catch (error) {
    res.status(403).json({ error: 'Invalid refresh token' });
  }
});</code>
                </div>

                <div class="code-block">
<code>// Frontend - Axios Interceptor for Auto Refresh
import axios from 'axios';

let isRefreshing = false;
let failedQueue = [];

const processQueue = (error, token = null) => {
  failedQueue.forEach(prom => {
    if (error) {
      prom.reject(error);
    } else {
      prom.resolve(token);
    }
  });
  
  failedQueue = [];
};

// Response interceptor
axios.interceptors.response.use(
  (response) => response,
  async (error) => {
    const originalRequest = error.config;
    
    // If error is 401 and we haven't tried to refresh yet
    if (error.response?.status === 401 && !originalRequest._retry) {
      if (isRefreshing) {
        // If already refreshing, queue this request
        return new Promise((resolve, reject) => {
          failedQueue.push({ resolve, reject });
        })
          .then(token => {
            originalRequest.headers['Authorization'] = 'Bearer ' + token;
            return axios(originalRequest);
          })
          .catch(err => Promise.reject(err));
      }
      
      originalRequest._retry = true;
      isRefreshing = true;
      
      const refreshToken = localStorage.getItem('refreshToken');
      
      if (!refreshToken) {
        // No refresh token, redirect to login
        window.location.href = '/login';
        return Promise.reject(error);
      }
      
      try {
        // Request new access token
        const response = await axios.post('/api/refresh', { refreshToken });
        const { accessToken } = response.data;
        
        // Update stored token
        localStorage.setItem('accessToken', accessToken);
        
        // Update axios default header
        axios.defaults.headers.common['Authorization'] = 'Bearer ' + accessToken;
        
        // Process queued requests
        processQueue(null, accessToken);
        
        // Retry original request
        originalRequest.headers['Authorization'] = 'Bearer ' + accessToken;
        return axios(originalRequest);
      } catch (refreshError) {
        // Refresh failed, logout user
        processQueue(refreshError, null);
        localStorage.removeItem('accessToken');
        localStorage.removeItem('refreshToken');
        window.location.href = '/login';
        return Promise.reject(refreshError);
      } finally {
        isRefreshing = false;
      }
    }
    
    return Promise.reject(error);
  }
);

// Request interceptor to add token
axios.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('accessToken');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);</code>
                </div>

                <div class="hinglish-box">
                    <h3>üîê Refresh Token Best Practices:</h3>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>Short Access Tokens:</strong> 15-30 minutes expiry</li>
                        <li><strong>Long Refresh Tokens:</strong> 7-30 days expiry</li>
                        <li><strong>Secure Storage:</strong> HttpOnly cookies mein store karo</li>
                        <li><strong>Token Rotation:</strong> Har refresh pe naya refresh token do</li>
                        <li><strong>Revocation:</strong> Logout pe refresh token invalidate karo</li>
                        <li><strong>Single Use:</strong> Ek refresh token sirf ek baar use ho</li>
                    </ul>
                </div>

                <div class="interactive-demo">
                    <div class="demo-title">üéÆ Token Refresh Simulator</div>
                    <div style="text-align: center;">
                        <div style="margin: 20px 0;">
                            <span class="status-badge status-info" id="token-status">Access Token Valid</span>
                        </div>
                        <button class="primary-btn" onclick="simulateTokenExpiry()">‚è±Ô∏è Simulate Token Expiry</button>
                        <button class="primary-btn" onclick="refreshAccessToken()">üîÑ Refresh Token</button>
                        <div id="refresh-result" style="margin-top: 20px;"></div>
                    </div>
                </div>
            </div>

            <!-- Auth Providers Section -->
            <div id="providers" class="section">
                <h2>üîå Authentication Providers</h2>
                
                <div class="hinglish-box">
                    <p>Authentication providers third-party services hain jo authentication ko handle karte hain. Ye implementation ko easy aur secure banate hain.</p>
                </div>

                <h3>Popular Auth Providers</h3>
                <div class="storage-demo">
                    <div class="storage-card">
                        <h4>üî• Firebase Auth</h4>
                        <p>Google ka authentication service</p>
                        <ul style="text-align: left; margin-top: 10px; line-height: 1.8;">
                            <li>Email/Password</li>
                            <li>Social Login</li>
                            <li>Phone Auth</li>
                            <li>Anonymous Auth</li>
                        </ul>
                    </div>
                    <div class="storage-card">
                        <h4>üîê Auth0</h4>
                        <p>Enterprise-grade authentication</p>
                        <ul style="text-align: left; margin-top: 10px; line-height: 1.8;">
                            <li>Universal Login</li>
                            <li>MFA Support</li>
                            <li>Social Connections</li>
                            <li>Enterprise SSO</li>
                        </ul>
                    </div>
                    <div class="storage-card">
                        <h4>üîë Clerk</h4>
                        <p>Modern authentication for React</p>
                        <ul style="text-align: left; margin-top: 10px; line-height: 1.8;">
                            <li>Pre-built UI</li>
                            <li>User Management</li>
                            <li>Organizations</li>
                            <li>Easy Integration</li>
                        </ul>
                    </div>
                </div>

                <h3>Firebase Authentication</h3>
                <div class="code-block">
<code>// Firebase Setup
import { initializeApp } from 'firebase/app';
import { 
  getAuth, 
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  signOut,
  onAuthStateChanged,
  GoogleAuthProvider,
  signInWithPopup
} from 'firebase/auth';

// Firebase config
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  // ... other config
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// Sign Up
const signUp = async (email, password) => {
  try {
    const userCredential = await createUserWithEmailAndPassword(
      auth, 
      email, 
      password
    );
    const user = userCredential.user;
    console.log('User created:', user);
  } catch (error) {
    console.error('Error:', error.message);
  }
};

// Sign In
const signIn = async (email, password) => {
  try {
    const userCredential = await signInWithEmailAndPassword(
      auth, 
      email, 
      password
    );
    const user = userCredential.user;
    console.log('User signed in:', user);
  } catch (error) {
    console.error('Error:', error.message);
  }
};

// Sign Out
const logout = async () => {
  try {
    await signOut(auth);
    console.log('User signed out');
  } catch (error) {
    console.error('Error:', error.message);
  }
};

// Google Sign In
const signInWithGoogle = async () => {
  const provider = new GoogleAuthProvider();
  try {
    const result = await signInWithPopup(auth, provider);
    const user = result.user;
    console.log('Google user:', user);
  } catch (error) {
    console.error('Error:', error.message);
  }
};

// Auth State Observer
onAuthStateChanged(auth, (user) => {
  if (user) {
    console.log('User is signed in:', user);
  } else {
    console.log('User is signed out');
  }
});

// React Component Example
import { useState, useEffect } from 'react';

function App() {
  const [user, setUser] = useState(null);
  
  useEffect(() => {
    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {
      setUser(currentUser);
    });
    
    return () => unsubscribe();
  }, []);
  
  return (
    &lt;div&gt;
      {user ? (
        &lt;div&gt;
          &lt;p&gt;Welcome, {user.email}&lt;/p&gt;
          &lt;button onClick={logout}&gt;Logout&lt;/button&gt;
        &lt;/div&gt;
      ) : (
        &lt;div&gt;
          &lt;button onClick={() => signIn('user@example.com', 'password')}&gt;
            Login
          &lt;/button&gt;
          &lt;button onClick={signInWithGoogle}&gt;
            Sign in with Google
          &lt;/button&gt;
        &lt;/div&gt;
      )}
    &lt;/div&gt;
  );
}</code>
                </div>

                <h3>Auth0 Implementation</h3>
                <div class="code-block">
<code>// Auth0 Setup
import { Auth0Provider, useAuth0 } from '@auth0/auth0-react';

// Wrap your app with Auth0Provider
function App() {
  return (
    &lt;Auth0Provider
      domain="YOUR_DOMAIN.auth0.com"
      clientId="YOUR_CLIENT_ID"
      redirectUri={window.location.origin}
    &gt;
      &lt;MyApp /&gt;
    &lt;/Auth0Provider&gt;
  );
}

// Login Component
function LoginButton() {
  const { loginWithRedirect } = useAuth0();
  
  return (
    &lt;button onClick={() => loginWithRedirect()}&gt;
      Log In
    &lt;/button&gt;
  );
}

// Logout Component
function LogoutButton() {
  const { logout } = useAuth0();
  
  return (
    &lt;button onClick={() => logout({ returnTo: window.location.origin })}&gt;
      Log Out
    &lt;/button&gt;
  );
}

// Profile Component
function Profile() {
  const { user, isAuthenticated, isLoading } = useAuth0();
  
  if (isLoading) {
    return &lt;div&gt;Loading...&lt;/div&gt;;
  }
  
  if (!isAuthenticated) {
    return &lt;div&gt;Not authenticated&lt;/div&gt;;
  }
  
  return (
    &lt;div&gt;
      &lt;img src={user.picture} alt={user.name} /&gt;
      &lt;h2&gt;{user.name}&lt;/h2&gt;
      &lt;p&gt;{user.email}&lt;/p&gt;
    &lt;/div&gt;
  );
}

// Protected Route with Auth0
import { withAuthenticationRequired } from '@auth0/auth0-react';

const ProtectedRoute = ({ component, ...args }) => {
  const Component = withAuthenticationRequired(component, {
    onRedirecting: () => &lt;div&gt;Loading...&lt;/div&gt;,
  });
  
  return &lt;Component {...args} /&gt;;
};

// Usage
&lt;Route 
  path="/dashboard" 
  element={&lt;ProtectedRoute component={Dashboard} /&gt;} 
/&gt;</code>
                </div>

                <div class="pros-cons">
                    <div class="pros">
                        <h4>‚úÖ Auth Providers ke Fayde</h4>
                        <ul style="margin-left: 20px; line-height: 2;">
                            <li>Quick implementation</li>
                            <li>Security best practices built-in</li>
                            <li>Social login easy</li>
                            <li>MFA support</li>
                            <li>User management dashboard</li>
                            <li>Scalable infrastructure</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4>‚ùå Limitations</h4>
                        <ul style="margin-left: 20px; line-height: 2;">
                            <li>Third-party dependency</li>
                            <li>Cost for large scale</li>
                            <li>Less customization</li>
                            <li>Vendor lock-in</li>
                            <li>Learning curve</li>
                        </ul>
                    </div>
                </div>

                <div class="hinglish-box">
                    <h3>üéØ Kab Kaunsa Use Karein?</h3>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li><strong>Firebase:</strong> Quick prototypes, mobile apps, Google ecosystem</li>
                        <li><strong>Auth0:</strong> Enterprise apps, complex requirements, compliance</li>
                        <li><strong>Custom JWT:</strong> Full control, specific requirements, learning</li>
                        <li><strong>Clerk:</strong> Modern React apps, easy integration, good DX</li>
                    </ul>
                </div>
            </div>

            <!-- Quiz Section -->
            <div id="quiz" class="section">
                <div class="quiz-section">
                    <h2 style="color: white; text-align: center; margin-bottom: 40px;">üéØ Interview Questions</h2>
                    
                    <!-- Question 1 -->
                    <div class="question-card" onclick="toggleAnswer(1)">
                        <div class="question-header">
                            <span>1. JWT kya hai aur ye kaise kaam karta hai?</span>
                            <div>
                                <span class="difficulty-badge easy">Easy</span>
                                <span class="toggle-icon" id="icon-1">‚ñº</span>
                            </div>
                        </div>
                        <div class="answer" id="answer-1">
                            <p><strong>Answer:</strong></p>
                            <p><strong>JWT (JSON Web Token)</strong> ek compact, self-contained token hai jo user ki identity aur claims ko securely transmit karta hai.</p>
                            
                            <p style="margin-top: 15px;"><strong>Structure:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>Header:</strong> Algorithm aur token type (Base64 encoded)</li>
                                <li><strong>Payload:</strong> User data aur claims (Base64 encoded)</li>
                                <li><strong>Signature:</strong> Verification ke liye hash (HMAC/RSA)</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>Working:</strong></p>
                            <ol style="margin-left: 20px;">
                                <li>User login karta hai</li>
                                <li>Server JWT token generate karta hai</li>
                                <li>Client token ko store karta hai (localStorage/cookie)</li>
                                <li>Har request mein token bhejta hai (Authorization header)</li>
                                <li>Server token verify karta hai aur access deta hai</li>
                            </ol>
                            
                            <p style="margin-top: 15px;"><strong>Benefits:</strong> Stateless, scalable, cross-domain support</p>
                        </div>
                    </div>

                    <!-- Question 2 -->
                    <div class="question-card" onclick="toggleAnswer(2)">
                        <div class="question-header">
                            <span>2. LocalStorage, Cookies, aur HttpOnly Cookies mein kya difference hai?</span>
                            <div>
                                <span class="difficulty-badge medium">Medium</span>
                                <span class="toggle-icon" id="icon-2">‚ñº</span>
                            </div>
                        </div>
                        <div class="answer" id="answer-2">
                            <p><strong>Answer:</strong></p>
                            
                            <p><strong>LocalStorage:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Capacity: ~5-10 MB</li>
                                <li>JavaScript se access ho sakta hai</li>
                                <li>XSS attacks ke liye vulnerable</li>
                                <li>Manually requests mein add karna padta hai</li>
                                <li>Best for: SPAs, non-sensitive data</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>Cookies:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Capacity: ~4 KB per cookie</li>
                                <li>JavaScript aur server dono access kar sakte hain</li>
                                <li>Automatically requests ke saath send hote hain</li>
                                <li>XSS aur CSRF dono ke liye vulnerable</li>
                                <li>Expiration set kar sakte hain</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>HttpOnly Cookies:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>JavaScript se access NAHI ho sakta</li>
                                <li>XSS attacks se protected</li>
                                <li>Server-side only access</li>
                                <li>CSRF protection ke liye SameSite flag use karo</li>
                                <li>Best for: Authentication tokens (most secure)</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>Recommendation:</strong> Authentication ke liye HttpOnly Cookies sabse secure option hai.</p>
                        </div>
                    </div>

                    <!-- Question 3 -->
                    <div class="question-card" onclick="toggleAnswer(3)">
                        <div class="question-header">
                            <span>3. Protected Routes kaise implement karte hain React mein?</span>
                            <div>
                                <span class="difficulty-badge medium">Medium</span>
                                <span class="toggle-icon" id="icon-3">‚ñº</span>
                            </div>
                        </div>
                        <div class="answer" id="answer-3">
                            <p><strong>Answer:</strong></p>
                            <p>Protected Routes implement karne ke multiple ways hain:</p>
                            
                            <p style="margin-top: 15px;"><strong>Method 1: Simple ProtectedRoute Component</strong></p>
                            <div class="code-block" style="margin-top: 10px;">
<code>const ProtectedRoute = ({ children }) => {
  const token = localStorage.getItem('token');
  
  if (!token) {
    return &lt;Navigate to="/login" replace /&gt;;
  }
  
  return children;
};

// Usage
&lt;Route 
  path="/dashboard" 
  element={
    &lt;ProtectedRoute&gt;
      &lt;Dashboard /&gt;
    &lt;/ProtectedRoute&gt;
  } 
/&gt;</code>
                            </div>
                            
                            <p style="margin-top: 15px;"><strong>Method 2: Context-Based (Better)</strong></p>
                            <div class="code-block" style="margin-top: 10px;">
<code>const ProtectedRoute = ({ children }) => {
  const { user, loading } = useAuth();
  
  if (loading) return &lt;Loading /&gt;;
  if (!user) return &lt;Navigate to="/login" /&gt;;
  
  return children;
};</code>
                            </div>
                            
                            <p style="margin-top: 15px;"><strong>Method 3: Role-Based Access</strong></p>
                            <div class="code-block" style="margin-top: 10px;">
<code>const ProtectedRoute = ({ children, requiredRole }) => {
  const { user } = useAuth();
  
  if (!user) return &lt;Navigate to="/login" /&gt;;
  if (requiredRole && user.role !== requiredRole) {
    return &lt;Navigate to="/unauthorized" /&gt;;
  }
  
  return children;
};</code>
                            </div>
                            
                            <p style="margin-top: 15px;"><strong>Key Points:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Token validation zaroori hai</li>
                                <li>Loading state handle karo</li>
                                <li>Redirect logic proper rakho</li>
                                <li>Role-based access implement karo if needed</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Question 4 -->
                    <div class="question-card" onclick="toggleAnswer(4)">
                        <div class="question-header">
                            <span>4. Refresh Tokens kya hain aur kyun use karte hain?</span>
                            <div>
                                <span class="difficulty-badge hard">Hard</span>
                                <span class="toggle-icon" id="icon-4">‚ñº</span>
                            </div>
                        </div>
                        <div class="answer" id="answer-4">
                            <p><strong>Answer:</strong></p>
                            <p><strong>Refresh Tokens</strong> long-lived tokens hote hain jo new access tokens generate karne ke liye use hote hain.</p>
                            
                            <p style="margin-top: 15px;"><strong>Why Use Refresh Tokens?</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>Security:</strong> Access tokens short-lived (15 min) - agar steal ho jaye toh limited damage</li>
                                <li><strong>User Experience:</strong> User ko baar-baar login nahi karna padta</li>
                                <li><strong>Revocation:</strong> Refresh tokens ko database mein store karke easily revoke kar sakte hain</li>
                                <li><strong>Session Management:</strong> Long sessions maintain kar sakte hain securely</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>Flow:</strong></p>
                            <ol style="margin-left: 20px;">
                                <li>Login pe dono tokens milte hain (access + refresh)</li>
                                <li>Access token se API calls karo</li>
                                <li>Access token expire hone pe 401 error</li>
                                <li>Refresh token se new access token request karo</li>
                                <li>New access token se original request retry karo</li>
                            </ol>
                            
                            <p style="margin-top: 15px;"><strong>Implementation Tips:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Access token: 15-30 minutes</li>
                                <li>Refresh token: 7-30 days</li>
                                <li>Refresh tokens ko HttpOnly cookies mein store karo</li>
                                <li>Token rotation implement karo (har refresh pe naya refresh token)</li>
                                <li>Axios interceptor use karo automatic refresh ke liye</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Question 5 -->
                    <div class="question-card" onclick="toggleAnswer(5)">
                        <div class="question-header">
                            <span>5. XSS aur CSRF attacks kya hain? Kaise prevent karein?</span>
                            <div>
                                <span class="difficulty-badge hard">Hard</span>
                                <span class="toggle-icon" id="icon-5">‚ñº</span>
                            </div>
                        </div>
                        <div class="answer" id="answer-5">
                            <p><strong>Answer:</strong></p>
                            
                            <p><strong>XSS (Cross-Site Scripting):</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Attacker malicious JavaScript inject karta hai</li>
                                <li>LocalStorage/Cookies se tokens chura sakta hai</li>
                                <li>User ke behalf pe actions perform kar sakta hai</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>XSS Prevention:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>HttpOnly cookies use karo (JavaScript access nahi)</li>
                                <li>Input sanitization karo</li>
                                <li>Content Security Policy (CSP) headers use karo</li>
                                <li>React automatically escapes content (safe by default)</li>
                                <li>dangerouslySetInnerHTML se bacho</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>CSRF (Cross-Site Request Forgery):</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Attacker user ke behalf pe unauthorized requests bhejta hai</li>
                                <li>Cookies automatically send hote hain (browser behavior)</li>
                                <li>User logged in hai toh attack successful ho sakta hai</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>CSRF Prevention:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>SameSite cookie attribute use karo (SameSite=Strict/Lax)</li>
                                <li>CSRF tokens use karo (unique token har request mein)</li>
                                <li>Custom headers check karo (X-Requested-With)</li>
                                <li>Origin/Referer headers verify karo</li>
                                <li>LocalStorage use karo (CSRF se safe, but XSS vulnerable)</li>
                            </ul>
                            
                            <div class="code-block" style="margin-top: 15px;">
<code>// CSRF Token Implementation
// Backend
app.use(csrf());
app.get('/api/csrf-token', (req, res) => {
  res.json({ csrfToken: req.csrfToken() });
});

// Frontend
const csrfToken = await fetch('/api/csrf-token').then(r => r.json());
axios.defaults.headers.common['X-CSRF-Token'] = csrfToken;

// Cookie with SameSite
res.cookie('token', jwt, {
  httpOnly: true,
  secure: true,
  sameSite: 'strict'
});</code>
                            </div>
                        </div>
                    </div>

                    <!-- Question 6 -->
                    <div class="question-card" onclick="toggleAnswer(6)">
                        <div class="question-header">
                            <span>6. Session-based vs Token-based authentication mein kya difference hai?</span>
                            <div>
                                <span class="difficulty-badge medium">Medium</span>
                                <span class="toggle-icon" id="icon-6">‚ñº</span>
                            </div>
                        </div>
                        <div class="answer" id="answer-6">
                            <p><strong>Answer:</strong></p>
                            
                            <p><strong>Session-Based Authentication:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Server pe session store hota hai (memory/database/Redis)</li>
                                <li>Client ko session ID milta hai (cookie mein)</li>
                                <li>Har request pe server session verify karta hai</li>
                                <li>Stateful - server ko session track karna padta hai</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>Token-Based Authentication (JWT):</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>Server token generate karta hai</li>
                                <li>Client token store karta hai</li>
                                <li>Token self-contained hai (sab info token mein)</li>
                                <li>Stateless - server ko kuch store nahi karna</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>Comparison:</strong></p>
                            <table class="comparison-table" style="margin-top: 10px;">
                                <tr>
                                    <th>Feature</th>
                                    <th>Session-Based</th>
                                    <th>Token-Based</th>
                                </tr>
                                <tr>
                                    <td>Storage</td>
                                    <td>Server-side</td>
                                    <td>Client-side</td>
                                </tr>
                                <tr>
                                    <td>Scalability</td>
                                    <td>Difficult (session sync)</td>
                                    <td>Easy (stateless)</td>
                                </tr>
                                <tr>
                                    <td>Revocation</td>
                                    <td>Easy (delete session)</td>
                                    <td>Difficult (token valid until expiry)</td>
                                </tr>
                                <tr>
                                    <td>Mobile Apps</td>
                                    <td>Complex</td>
                                    <td>Easy</td>
                                </tr>
                                <tr>
                                    <td>Cross-Domain</td>
                                    <td>Difficult</td>
                                    <td>Easy</td>
                                </tr>
                            </table>
                            
                            <p style="margin-top: 15px;"><strong>When to Use:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>Session-Based:</strong> Traditional web apps, need instant revocation</li>
                                <li><strong>Token-Based:</strong> SPAs, mobile apps, microservices, APIs</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Question 7 -->
                    <div class="question-card" onclick="toggleAnswer(7)">
                        <div class="question-header">
                            <span>7. OAuth 2.0 kya hai aur social login kaise implement karein?</span>
                            <div>
                                <span class="difficulty-badge hard">Hard</span>
                                <span class="toggle-icon" id="icon-7">‚ñº</span>
                            </div>
                        </div>
                        <div class="answer" id="answer-7">
                            <p><strong>Answer:</strong></p>
                            <p><strong>OAuth 2.0</strong> ek authorization framework hai jo third-party applications ko user ke resources access karne ki permission deta hai bina password share kiye.</p>
                            
                            <p style="margin-top: 15px;"><strong>Key Concepts:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li><strong>Resource Owner:</strong> User (jo data ka owner hai)</li>
                                <li><strong>Client:</strong> Application (jo access chahta hai)</li>
                                <li><strong>Authorization Server:</strong> OAuth provider (Google, Facebook)</li>
                                <li><strong>Resource Server:</strong> API server (jahan data hai)</li>
                            </ul>
                            
                            <p style="margin-top: 15px;"><strong>OAuth Flow:</strong></p>
                            <ol style="margin-left: 20px;">
                                <li>User "Login with Google" click karta hai</li>
                                <li>Redirect to Google authorization page</li>
                                <li>User permission deta hai</li>
                                <li>Google authorization code return karta hai</li>
                                <li>App code ko access token ke liye exchange karta hai</li>
                                <li>Access token se user info fetch karo</li>
                                <li>User ko login kar do</li>
                            </ol>
                            
                            <p style="margin-top: 15px;"><strong>Implementation Example (Google):</strong></p>
                            <div class="code-block" style="margin-top: 10px;">
<code>// Backend (Node.js)
const passport = require('passport');
const GoogleStrategy = require('passport-google-oauth20').Strategy;

passport.use(new GoogleStrategy({
    clientID: process.env.GOOGLE_CLIENT_ID,
    clientSecret: process.env.GOOGLE_CLIENT_SECRET,
    callbackURL: "/auth/google/callback"
  },
  async (accessToken, refreshToken, profile, done) => {
    // Find or create user
    let user = await User.findOne({ googleId: profile.id });
    
    if (!user) {
      user = await User.create({
        googleId: profile.id,
        email: profile.emails[0].value,
        name: profile.displayName
      });
    }
    
    return done(null, user);
  }
));

// Routes
app.get('/auth/google',
  passport.authenticate('google', { scope: ['profile', 'email'] })
);

app.get('/auth/google/callback',
  passport.authenticate('google', { failureRedirect: '/login' }),
  (req, res) => {
    // Generate JWT
    const token = jwt.sign({ userId: req.user._id }, process.env.JWT_SECRET);
    res.redirect(`/dashboard?token=${token}`);
  }
);

// Frontend
&lt;button onClick={() => window.location.href = '/auth/google'}&gt;
  Login with Google
&lt;/button&gt;</code>
                            </div>
                            
                            <p style="margin-top: 15px;"><strong>Benefits:</strong></p>
                            <ul style="margin-left: 20px;">
                                <li>User ko naya account nahi banana padta</li>
                                <li>Password management ki tension nahi</li>
                                <li>Trusted providers (Google, Facebook) use karte hain</li>
                                <li>Quick signup/login process</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Navigation
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            
            document.getElementById(sectionId).classList.add('active');
            
            const navButtons = document.querySelectorAll('.nav-btn');
            navButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // JWT Generator
        function generateJWT() {
            const userId = document.getElementById('jwt-userid').value;
            const email = document.getElementById('jwt-email').value;
            const role = document.getElementById('jwt-role').value;

            const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));
            const payload = btoa(JSON.stringify({
                userId: userId,
                email: email,
                role: role,
                iat: Math.floor(Date.now() / 1000),
                exp: Math.floor(Date.now() / 1000) + 3600
            }));
            const signature = 'SIGNATURE_HASH_HERE';

            const token = `${header}.${payload}.${signature}`;
            document.getElementById('jwt-output').textContent = token;
        }

        function decodeJWT() {
            const token = document.getElementById('jwt-output').textContent;
            if (token === 'Click "Generate JWT" to create a token') {
                alert('Please generate a token first!');
                return;
            }

            const parts = token.split('.');
            const header = JSON.parse(atob(parts[0]));
            const payload = JSON.parse(atob(parts[1]));

            const decoded = document.getElementById('jwt-decoded');
            decoded.innerHTML = `
                <div class="info-card">
                    <h4>Decoded JWT</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h5 style="color: #e74c3c;">Header:</h5>
                            <pre style="background: #2d3436; color: #dfe6e9; padding: 15px; border-radius: 8px;">${JSON.stringify(header, null, 2)}</pre>
                        </div>
                        <div>
                            <h5 style="color: #f39c12;">Payload:</h5>
                            <pre style="background: #2d3436; color: #dfe6e9; padding: 15px; border-radius: 8px;">${JSON.stringify(payload, null, 2)}</pre>
                        </div>
                    </div>
                </div>
            `;
        }

        // Storage Demo
        function testStorage(type) {
            const resultDiv = document.getElementById('storage-result');
            const testData = { token: 'test_token_12345', timestamp: Date.now() };

            if (type === 'local') {
                localStorage.setItem('authTest', JSON.stringify(testData));
                const retrieved = localStorage.getItem('authTest');
                resultDiv.innerHTML = `
                    <div class="info-card">
                        <h4>üì¶ LocalStorage Test</h4>
                        <p><strong>Stored:</strong> ${JSON.stringify(testData)}</p>
                        <p><strong>Retrieved:</strong> ${retrieved}</p>
                        <p><strong>Accessible from JavaScript:</strong> <span class="status-badge status-success">Yes</span></p>
                        <p><strong>Sent with requests:</strong> <span class="status-badge status-error">No (manual)</span></p>
                    </div>
                `;
            } else if (type === 'cookie') {
                document.cookie = `authTest=${JSON.stringify(testData)}; path=/; max-age=3600`;
                const cookies = document.cookie;
                resultDiv.innerHTML = `
                    <div class="info-card">
                        <h4>üç™ Cookie Test</h4>
                        <p><strong>Stored:</strong> ${JSON.stringify(testData)}</p>
                        <p><strong>All Cookies:</strong> ${cookies}</p>
                        <p><strong>Accessible from JavaScript:</strong> <span class="status-badge status-success">Yes</span></p>
                        <p><strong>Sent with requests:</strong> <span class="status-badge status-success">Yes (automatic)</span></p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="info-card">
                        <h4>üîí HttpOnly Cookie Test</h4>
                        <p><strong>Note:</strong> HttpOnly cookies can only be set by the server.</p>
                        <p><strong>Accessible from JavaScript:</strong> <span class="status-badge status-error">No</span></p>
                        <p><strong>Sent with requests:</strong> <span class="status-badge status-success">Yes (automatic)</span></p>
                        <p><strong>XSS Protection:</strong> <span class="status-badge status-success">Protected</span></p>
                        <p style="margin-top: 15px;">This is the most secure option for storing authentication tokens!</p>
                    </div>
                `;
            }
        }

        // Auth Flow Simulator
        let isLoggedIn = false;
        let currentToken = null;

        function simulateLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            const statusDiv = document.getElementById('auth-status');
            statusDiv.innerHTML = '<div class="loading"></div> Authenticating...';

            setTimeout(() => {
                if (email && password) {
                    isLoggedIn = true;
                    currentToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiIxMjM0NSIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.signature';
                    
                    statusDiv.innerHTML = `
                        <span class="status-badge status-success">‚úÖ Logged In</span>
                        <p style="margin-top: 10px;"><strong>User:</strong> ${email}</p>
                        <p><strong>Status:</strong> Authenticated</p>
                    `;
                    
                    document.getElementById('auth-token').textContent = currentToken;
                } else {
                    statusDiv.innerHTML = `
                        <span class="status-badge status-error">‚ùå Login Failed</span>
                        <p style="margin-top: 10px;">Please enter valid credentials</p>
                    `;
                }
            }, 1500);
        }

        function simulateLogout() {
            const statusDiv = document.getElementById('auth-status');
            
            isLoggedIn = false;
            currentToken = null;
            
            statusDiv.innerHTML = `
                <span class="status-badge status-warning">üö™ Logged Out</span>
                <p style="margin-top: 10px;">Session terminated</p>
            `;
            
            document.getElementById('auth-token').textContent = 'No active token';
        }

        // Protected Route Simulator
        function accessProtectedRoute(route) {
            const resultDiv = document.getElementById('route-access-result');
            
            resultDiv.innerHTML = '<div class="loading"></div> Checking authentication...';
            
            setTimeout(() => {
                if (!isLoggedIn) {
                    resultDiv.innerHTML = `
                        <div style="background: #f8d7da; padding: 20px; border-radius: 10px; border-left: 5px solid #dc3545;">
                            <h4 style="color: #721c24;">üîí Access Denied</h4>
                            <p>You need to login to access <strong>${route}</strong></p>
                            <p style="margin-top: 10px;">Redirecting to login page...</p>
                        </div>
                    `;
                } else if (route === 'admin' && !currentToken.includes('admin')) {
                    resultDiv.innerHTML = `
                        <div style="background: #fff3cd; padding: 20px; border-radius: 10px; border-left: 5px solid #ffc107;">
                            <h4 style="color: #856404;">‚ö†Ô∏è Unauthorized</h4>
                            <p>You don't have permission to access <strong>${route}</strong></p>
                            <p style="margin-top: 10px;">Required role: Admin</p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: #d4edda; padding: 20px; border-radius: 10px; border-left: 5px solid #28a745;">
                            <h4 style="color: #155724;">‚úÖ Access Granted</h4>
                            <p>Welcome to <strong>${route}</strong>!</p>
                            <p style="margin-top: 10px;">Token verified successfully</p>
                        </div>
                    `;
                }
            }, 1000);
        }

        // Token Refresh Simulator
        let tokenExpired = false;

        function simulateTokenExpiry() {
            tokenExpired = true;
            document.getElementById('token-status').textContent = 'Access Token Expired';
            document.getElementById('token-status').className = 'status-badge status-error';
            
            document.getElementById('refresh-result').innerHTML = `
                <div class="info-card">
                    <h4>‚è±Ô∏è Token Expired</h4>
                    <p>Your access token has expired. Click "Refresh Token" to get a new one.</p>
                </div>
            `;
        }

        function refreshAccessToken() {
            const resultDiv = document.getElementById('refresh-result');
            
            if (!tokenExpired) {
                resultDiv.innerHTML = `
                    <div class="info-card">
                        <h4>‚ÑπÔ∏è Token Still Valid</h4>
                        <p>Your access token is still valid. No need to refresh yet.</p>
                    </div>
                `;
                return;
            }
            
            resultDiv.innerHTML = '<div class="loading"></div> Refreshing token...';
            
            setTimeout(() => {
                tokenExpired = false;
                document.getElementById('token-status').textContent = 'Access Token Valid';
                document.getElementById('token-status').className = 'status-badge status-success';
                
                resultDiv.innerHTML = `
                    <div class="info-card">
                        <h4>‚úÖ Token Refreshed</h4>
                        <p><strong>New Access Token:</strong> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.NEW_TOKEN.signature</p>
                        <p style="margin-top: 10px;">Your session has been extended. You can continue using the app.</p>
                    </div>
                `;
            }, 1500);
        }

        // Quiz Toggle
        function toggleAnswer(questionNum) {
            const answer = document.getElementById(`answer-${questionNum}`);
            const icon = document.getElementById(`icon-${questionNum}`);
            
            answer.classList.toggle('show');
            icon.classList.toggle('rotated');
        }
    </script>
</body>
</html>